{"assets":{"BD50CF5782E79961468EE25A585C263A":{"type":"texture","index":7,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":1920,"height":1080},"7E09CED92E23CCF90CE5B16A90602C55":{"type":"texture","index":1,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":962,"height":62},"4296E54C45A6264715204297D66D6DCA":{"type":"texture","index":2,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":171,"height":896},"C25C25FF361FB24FC35F6B120D2F252D":{"type":"texture","index":0,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":1920,"height":1080},"7C4E1F6010CEF29B83A62B7813154690":{"type":"texture","index":3,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":652,"height":205},"BAC3B18083DD6755EA1FCCE1B75491C1":{"type":"texture","index":5,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":560,"height":448},"BC3F5294029FE4948FE58D45307782EE":{"type":"texture","index":4,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":528,"height":423},"68CD03AE3BD9EE91E8954131BBB0167E":{"type":"texture","index":6,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":222,"height":60},"13B84F6ECF041FFADE3D17E8724E4B95":{"type":"texture","index":8,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/E2BEFE2A-4CA2-4B5E-946B-9155E581F214.pdf"},"width":1920,"height":1080}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":811.56660199972066,"pointY":913.86364841461182},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":205,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"3C5A5888-64C5-45F0-A79D-ADC6AC019884","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":474.43339800027934,"pointY":-271.36364841461182},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":205,"hidden":false,"anchorPoint":{"pointX":0.72765858588999899,"pointY":-1.3237251142176185}},"layers":[{"animations":[{"timeOffset":0,"beginTime":1e-100,"repeatCount":0,"animations":[{"timeOffset":0,"from":{"scalar":true},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.0001,"to":{"scalar":false}},{"timeOffset":0,"from":{"scalar":false},"beginTime":0.0001,"repeatCount":0,"fillMode":"forwards","property":"hidden","autoreverses":false,"duration":0.0099000000000000008,"to":{"scalar":false}}],"fillMode":"both","autoreverses":false,"duration":0.01}],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":324.43339800027934,"pointY":101.13635158538818},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":205,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"7C4E1F6010CEF29B83A62B7813154690"}]}]},"effects":[],"duration":0.01,"type":"buildIn","attributes":{"direction":0},"name":"apple:appear","objectID":"3C5A5888-64C5-45F0-A79D-ADC6AC019884"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Plots can be built programmatically","targetRectangle":{"y":80,"x":478.11200000000002,"width":963.77599999999984,"height":76.1435546875}},{"text":"if(label_cell_groups) {","targetRectangle":{"y":815.36364841461182,"x":580.76361083984375,"width":166.166015625,"height":18}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":833.36364841461182,"x":580.76361083984375,"width":382.904296875,"height":18}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":851.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":869.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":887.36364841461182,"x":580.76361083984375,"width":549.0703125,"height":18}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":905.36364841461182,"x":580.76361083984375,"width":455.150390625,"height":18}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":923.36364841461182,"x":580.76361083984375,"width":469.599609375,"height":18}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":941.36364841461182,"x":580.76361083984375,"width":223.962890625,"height":18}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":959.36364841461182,"x":580.76361083984375,"width":317.8828125,"height":18}},{"text":"  }","targetRectangle":{"y":977.36364841461182,"x":580.76361083984375,"width":21.673828125,"height":18}},{"text":"plot_cells <- function(cds,","targetRectangle":{"y":162.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       x=1,","targetRectangle":{"y":164.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       y=2,","targetRectangle":{"y":166.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       reduction_method = c(\\\"UMAP\\\", \\\"tSNE\\\", \\\"PCA\\\", \\\"LSI\\\", \\\"Aligned\\\"),","targetRectangle":{"y":168.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                       color_cells_by=\\\"cluster\\\",","targetRectangle":{"y":170.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       group_cells_by=c(\\\"cluster\\\", \\\"partition\\\"),","targetRectangle":{"y":172.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                       genes=NULL,","targetRectangle":{"y":174.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"                       show_trajectory_graph=TRUE,","targetRectangle":{"y":176.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                       trajectory_graph_color=\\\"grey28\\\",","targetRectangle":{"y":178.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                       trajectory_graph_segment_size=0.75,","targetRectangle":{"y":180.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                       norm_method = c(\\\"log\\\", \\\"size_only\\\"),","targetRectangle":{"y":182.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"                       label_cell_groups = TRUE,","targetRectangle":{"y":184.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_groups_by_cluster=TRUE,","targetRectangle":{"y":186.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"                       group_label_size=2,","targetRectangle":{"y":188.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       labels_per_group=1,","targetRectangle":{"y":190.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       label_branch_points=TRUE,","targetRectangle":{"y":192.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_roots=TRUE,","targetRectangle":{"y":194.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                       label_leaves=TRUE,","targetRectangle":{"y":196.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"                       graph_label_size=2,","targetRectangle":{"y":198.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       cell_size=0.35,","targetRectangle":{"y":200.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"                       cell_stroke= I(cell_size \/ 2),","targetRectangle":{"y":202.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                       alpha = 1,","targetRectangle":{"y":204.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                       min_expr=0.1,","targetRectangle":{"y":206.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                       rasterize=FALSE,","targetRectangle":{"y":208.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                       scale_to_range=FALSE) {","targetRectangle":{"y":210.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"  reduction_method <- match.arg(reduction_method)","targetRectangle":{"y":212.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"  assertthat::assert_that(methods::is(cds, \\\"cell_data_set\\\"))","targetRectangle":{"y":214.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"  assertthat::assert_that(!is.null(reducedDims(cds)[[reduction_method]]),","targetRectangle":{"y":216.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                          msg = paste(\\\"No dimensionality reduction for\\\",","targetRectangle":{"y":218.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                      reduction_method, \\\"calculated.\\\",","targetRectangle":{"y":220.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                                      \\\"Please run reduce_dimensions with\\\",","targetRectangle":{"y":222.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                      \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":224.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"                                      \\\"before attempting to plot.\\\"))","targetRectangle":{"y":226.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"  low_dim_coords <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":228.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  assertthat::assert_that(ncol(low_dim_coords) >=max(x,y),","targetRectangle":{"y":230.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          msg = paste(\\\"x and\/or y is too large. x and y must\\\",","targetRectangle":{"y":232.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be dimensions in reduced dimension\\\",","targetRectangle":{"y":234.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"                                      \\\"space.\\\"))","targetRectangle":{"y":236.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"  if(!is.null(color_cells_by)) {","targetRectangle":{"y":238.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"    assertthat::assert_that(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\",","targetRectangle":{"y":240.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                                                  \\\"pseudotime\\\") |","targetRectangle":{"y":242.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                              color_cells_by %in% names(colData(cds)),","targetRectangle":{"y":244.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            msg = paste(\\\"color_cells_by must one of\\\",","targetRectangle":{"y":246.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                        \\\"'cluster', 'partition', 'pseudotime,\\\",","targetRectangle":{"y":248.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                        \\\"or a column in the colData table.\\\"))","targetRectangle":{"y":250.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    if(color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":254.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      tryCatch({pseudotime(cds, reduction_method = reduction_method)},","targetRectangle":{"y":256.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"               error = function(x) {","targetRectangle":{"y":258.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                 stop(paste(\\\"No pseudotime for\\\", reduction_method,","targetRectangle":{"y":260.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            \\\"calculated. Please run order_cells with\\\",","targetRectangle":{"y":262.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":264.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"                            \\\"before attempting to color by pseudotime.\\\"))})","targetRectangle":{"y":266.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    }","targetRectangle":{"y":270.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":272.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(markers),","targetRectangle":{"y":274.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or markers must\\\",","targetRectangle":{"y":276.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be NULL, cannot color by both!\\\"))","targetRectangle":{"y":278.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"  norm_method = match.arg(norm_method)","targetRectangle":{"y":282.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"  group_cells_by=match.arg(group_cells_by)","targetRectangle":{"y":284.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(genes),","targetRectangle":{"y":286.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or genes must be\\\",","targetRectangle":{"y":288.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                      \\\"NULL, cannot color by both!\\\"))","targetRectangle":{"y":290.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"  if (show_trajectory_graph &&","targetRectangle":{"y":294.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"      is.null(principal_graph(cds)[[reduction_method]])) {","targetRectangle":{"y":296.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    message(\\\"No trajectory to plot. Has learn_graph() been called yet?\\\")","targetRectangle":{"y":298.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    show_trajectory_graph = FALSE","targetRectangle":{"y":300.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  }","targetRectangle":{"y":302.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  gene_short_name <- NA","targetRectangle":{"y":306.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  sample_name <- NA","targetRectangle":{"y":308.00000196695305,"x":362.40000017166153,"width":22.8779296875,"height":2}},{"text":"  #sample_state <- colData(cds)$State","targetRectangle":{"y":310.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  data_dim_1 <- NA","targetRectangle":{"y":312.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  data_dim_2 <- NA","targetRectangle":{"y":314.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  if (rasterize){","targetRectangle":{"y":316.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"    plotting_func <- ggrastr::geom_point_rast","targetRectangle":{"y":318.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"  }else{","targetRectangle":{"y":320.00000196695305,"x":362.40000017166153,"width":9.6328125,"height":2}},{"text":"    plotting_func <- ggplot2::geom_point","targetRectangle":{"y":322.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"  }","targetRectangle":{"y":324.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  S_matrix <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":328.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"  data_df <- data.frame(S_matrix[,c(x,y)])","targetRectangle":{"y":330.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  colnames(data_df) <- c(\\\"data_dim_1\\\", \\\"data_dim_2\\\")","targetRectangle":{"y":334.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"  data_df$sample_name <- row.names(data_df)","targetRectangle":{"y":336.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"  data_df <- as.data.frame(cbind(data_df, colData(cds)))","targetRectangle":{"y":340.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  if (group_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":342.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":344.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":346.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":348.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":350.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":352.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (group_cells_by == \\\"partition\\\") {","targetRectangle":{"y":354.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":356.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":358.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":360.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":362.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":364.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else{","targetRectangle":{"y":366.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    stop(\\\"Error: unrecognized way of grouping cells.\\\")","targetRectangle":{"y":368.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"  }","targetRectangle":{"y":370.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (color_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":374.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":376.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":378.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":380.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":382.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":384.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"partition\\\") {","targetRectangle":{"y":386.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":388.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":390.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":392.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":394.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":396.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":398.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":400.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({pseudotime(cds,","targetRectangle":{"y":402.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":404.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]}, error = function(e) {NULL})","targetRectangle":{"y":406.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"  } else{","targetRectangle":{"y":408.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    data_df$cell_color <- colData(cds)[data_df$sample_name,color_cells_by]","targetRectangle":{"y":410.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"  }","targetRectangle":{"y":412.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Graph info","targetRectangle":{"y":416.00000196695305,"x":362.40000017166153,"width":18.0615234375,"height":2}},{"text":"  if (show_trajectory_graph) {","targetRectangle":{"y":418.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"    ica_space_df <- t(cds@principal_graph_aux[[reduction_method]]$dp_mst) %>%","targetRectangle":{"y":422.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"      as.data.frame() %>%","targetRectangle":{"y":424.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      dplyr::select_(prin_graph_dim_1 = x, prin_graph_dim_2 = y) %>%","targetRectangle":{"y":426.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      dplyr::mutate(sample_name = rownames(.),","targetRectangle":{"y":428.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"                    sample_state = rownames(.))","targetRectangle":{"y":430.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"    dp_mst <- cds@principal_graph[[reduction_method]]","targetRectangle":{"y":434.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"    edge_df <- dp_mst %>%","targetRectangle":{"y":438.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      igraph::as_data_frame() %>%","targetRectangle":{"y":440.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      dplyr::select_(source = \\\"from\\\", target = \\\"to\\\") %>%","targetRectangle":{"y":442.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":444.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":446.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           source=\\\"sample_name\\\",","targetRectangle":{"y":448.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           source_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":450.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           source_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":452.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"source\\\") %>%","targetRectangle":{"y":454.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":456.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":458.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           target=\\\"sample_name\\\",","targetRectangle":{"y":460.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           target_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":462.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           target_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":464.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"target\\\")","targetRectangle":{"y":466.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  }","targetRectangle":{"y":468.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Marker genes","targetRectangle":{"y":472.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"  markers_exprs <- NULL","targetRectangle":{"y":474.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  expression_legend_label <- NULL","targetRectangle":{"y":476.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  if (!is.null(genes)) {","targetRectangle":{"y":478.00000196695305,"x":362.40000017166153,"width":28.8984375,"height":2}},{"text":"    if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":480.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"      markers = unlist(genes[,1], use.names=FALSE)","targetRectangle":{"y":482.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"    } else {","targetRectangle":{"y":484.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      markers = genes","targetRectangle":{"y":486.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"    }","targetRectangle":{"y":488.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    markers_rowData <- as.data.frame(subset(rowData(cds),","targetRectangle":{"y":490.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                                            gene_short_name %in% markers |","targetRectangle":{"y":492.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              row.names(rowData(cds)) %in%","targetRectangle":{"y":494.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              markers))","targetRectangle":{"y":496.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"    if (nrow(markers_rowData) == 0) {","targetRectangle":{"y":498.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      stop(\\\"None of the provided genes were found in the cds\\\")","targetRectangle":{"y":500.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    }","targetRectangle":{"y":502.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (nrow(markers_rowData) >= 1) {","targetRectangle":{"y":504.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      cds_exprs <- SingleCellExperiment::counts(cds)[row.names(markers_rowData), ,drop=FALSE]","targetRectangle":{"y":506.00000196695305,"x":362.40000017166153,"width":111.9814453125,"height":2}},{"text":"      cds_exprs <- Matrix::t(Matrix::t(cds_exprs)\/size_factors(cds))","targetRectangle":{"y":508.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":512.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"        genes = as.data.frame(genes)","targetRectangle":{"y":514.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        row.names(genes) = genes[,1]","targetRectangle":{"y":516.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        genes = genes[row.names(cds_exprs),]","targetRectangle":{"y":518.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"        agg_mat = as.matrix(aggregate_gene_expression(cds, genes, norm_method=norm_method, scale_agg_values=FALSE))","targetRectangle":{"y":522.00000196695305,"x":362.40000017166153,"width":138.4716796875,"height":2}},{"text":"        markers_exprs = agg_mat","targetRectangle":{"y":524.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":526.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":528.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        if (is.factor(genes[,2]))","targetRectangle":{"y":530.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"          markers_exprs$feature_id = factor(markers_exprs$feature_id,","targetRectangle":{"y":532.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                            levels=levels(genes[,2]))","targetRectangle":{"y":534.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        markers_exprs$feature_label <- markers_exprs$feature_id","targetRectangle":{"y":538.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        norm_method = \\\"size_only\\\"","targetRectangle":{"y":540.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        expression_legend_label = \\\"Expression score\\\"","targetRectangle":{"y":542.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"      } else {","targetRectangle":{"y":544.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        cds_exprs@x = round(10000*cds_exprs@x)\/10000","targetRectangle":{"y":546.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        markers_exprs = matrix(cds_exprs, nrow=nrow(markers_rowData))","targetRectangle":{"y":548.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        colnames(markers_exprs) = colnames(SingleCellExperiment::counts(cds))","targetRectangle":{"y":550.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        row.names(markers_exprs) = row.names(markers_rowData)","targetRectangle":{"y":552.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":554.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":556.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        markers_exprs <- merge(markers_exprs, markers_rowData,","targetRectangle":{"y":558.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                               by.x = \\\"feature_id\\\", by.y=\\\"row.names\\\")","targetRectangle":{"y":560.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        if (is.null(markers_exprs$gene_short_name)) {","targetRectangle":{"y":562.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":564.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$feature_id)","targetRectangle":{"y":566.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        } else {","targetRectangle":{"y":568.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":570.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$gene_short_name)","targetRectangle":{"y":572.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"        }","targetRectangle":{"y":574.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        markers_exprs$feature_label <- ifelse(is.na(markers_exprs$feature_label) | !as.character(markers_exprs$feature_label) %in% markers,","targetRectangle":{"y":578.00000196695305,"x":362.40000017166153,"width":167.3701171875,"height":2}},{"text":"                                              as.character(markers_exprs$feature_id),","targetRectangle":{"y":580.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                                              as.character(markers_exprs$feature_label))","targetRectangle":{"y":582.00000196695305,"x":362.40000017166153,"width":105.9609375,"height":2}},{"text":"        markers_exprs$feature_label <- factor(markers_exprs$feature_label,","targetRectangle":{"y":586.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              levels = markers)","targetRectangle":{"y":588.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        if (norm_method == \\\"size_only\\\")","targetRectangle":{"y":590.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"          expression_legend_label = \\\"Expression\\\"","targetRectangle":{"y":592.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        else","targetRectangle":{"y":594.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"          expression_legend_label = \\\"log10(Expression)\\\"","targetRectangle":{"y":596.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      }","targetRectangle":{"y":598.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      if (scale_to_range){","targetRectangle":{"y":602.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        markers_exprs = dplyr::group_by(markers_exprs, feature_label) %>%","targetRectangle":{"y":604.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"          dplyr::mutate(max_val_for_feature = max(value),","targetRectangle":{"y":606.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                        min_val_for_feature = min(value)) %>%","targetRectangle":{"y":608.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"          dplyr::mutate(value = 100 * (value - min_val_for_feature) \/ (max_val_for_feature - min_val_for_feature))","targetRectangle":{"y":610.00000196695305,"x":362.40000017166153,"width":137.267578125,"height":2}},{"text":"        expression_legend_label = \\\"% Max\\\"","targetRectangle":{"y":612.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      }","targetRectangle":{"y":614.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":616.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":618.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (label_cell_groups && is.null(color_cells_by) == FALSE){","targetRectangle":{"y":622.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"    if (is.null(data_df$cell_color)){","targetRectangle":{"y":624.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      if (is.null(genes)){","targetRectangle":{"y":626.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        message(paste(color_cells_by, \\\"not found in colData(cds), cells will\\\",","targetRectangle":{"y":628.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                      \\\"not be colored\\\"))","targetRectangle":{"y":630.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      }","targetRectangle":{"y":632.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      text_df = NULL","targetRectangle":{"y":634.00000196695305,"x":362.40000017166153,"width":24.08203125,"height":2}},{"text":"      label_cell_groups = FALSE","targetRectangle":{"y":636.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"    }else{","targetRectangle":{"y":638.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"      if(is.character(data_df$cell_color) || is.factor(data_df$cell_color)) {","targetRectangle":{"y":640.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        if (label_groups_by_cluster && is.null(data_df$cell_group) == FALSE){","targetRectangle":{"y":644.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"          text_df = data_df %>%","targetRectangle":{"y":646.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"            dplyr::group_by(cell_group) %>%","targetRectangle":{"y":648.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"            dplyr::mutate(cells_in_cluster= dplyr::n()) %>%","targetRectangle":{"y":650.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"            dplyr::group_by(cell_color, add=TRUE) %>%","targetRectangle":{"y":652.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"            dplyr::mutate(per=dplyr::n()\/cells_in_cluster)","targetRectangle":{"y":654.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":656.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":658.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":660.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":662.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":664.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":666.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":668.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":670.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_group) %>%","targetRectangle":{"y":672.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":674.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        } else {","targetRectangle":{"y":676.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          text_df = data_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":678.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::mutate(per=1)","targetRectangle":{"y":680.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":682.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":684.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":686.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":688.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":690.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":692.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":694.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":696.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":698.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":700.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        }","targetRectangle":{"y":702.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        text_df$label = as.character(text_df %>% dplyr::pull(cell_color))","targetRectangle":{"y":706.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"        # I feel like there's probably a good reason for the bit below, but I","targetRectangle":{"y":708.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        # hate it and I'm killing it for now.","targetRectangle":{"y":710.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        # text_df$label <- paste0(1:nrow(text_df))","targetRectangle":{"y":712.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        # text_df$process_label <- paste0(1:nrow(text_df), '_',","targetRectangle":{"y":714.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        # as.character(as.matrix(text_df[, 1])))","targetRectangle":{"y":716.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # process_label <- text_df$process_label","targetRectangle":{"y":718.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # names(process_label) <- as.character(as.matrix(text_df[, 1]))","targetRectangle":{"y":720.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"        # data_df[, group_by] <-","targetRectangle":{"y":722.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"        #  process_label[as.character(data_df[, group_by])]","targetRectangle":{"y":724.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"        # text_df$label = process_label","targetRectangle":{"y":726.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      } else {","targetRectangle":{"y":728.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        message(paste(\\\"Cells aren't colored in a way that allows them to\\\",","targetRectangle":{"y":730.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                      \\\"be grouped.\\\"))","targetRectangle":{"y":732.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"        text_df = NULL","targetRectangle":{"y":734.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"        label_cell_groups = FALSE","targetRectangle":{"y":736.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      }","targetRectangle":{"y":738.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":740.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":742.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (!is.null(markers_exprs) && nrow(markers_exprs) > 0){","targetRectangle":{"y":746.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    data_df <- merge(data_df, markers_exprs, by.x=\\\"sample_name\\\",","targetRectangle":{"y":748.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                     by.y=\\\"cell_id\\\")","targetRectangle":{"y":750.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"    data_df$value <- with(data_df, ifelse(value >= min_expr, value, NA))","targetRectangle":{"y":752.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    na_sub <- data_df[is.na(data_df$value),]","targetRectangle":{"y":754.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"    if(norm_method == \\\"size_only\\\"){","targetRectangle":{"y":756.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":758.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":760.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\", alpha = alpha,","targetRectangle":{"y":762.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                      data = na_sub) +","targetRectangle":{"y":764.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"        plotting_func(aes(color=value), size=I(cell_size),","targetRectangle":{"y":766.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                      stroke = I(cell_stroke), na.rm = TRUE) +","targetRectangle":{"y":768.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":770.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":772.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":774.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":776.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":778.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    } else {","targetRectangle":{"y":780.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":782.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":784.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\",","targetRectangle":{"y":786.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                      data = na_sub, alpha = alpha) +","targetRectangle":{"y":788.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        plotting_func(aes(color=log10(value+min_expr)),","targetRectangle":{"y":790.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                      size=I(cell_size), stroke = I(cell_stroke),","targetRectangle":{"y":792.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                      na.rm = TRUE, alpha = alpha) +","targetRectangle":{"y":794.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":796.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":798.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":800.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":802.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":804.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    }","targetRectangle":{"y":806.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  } else {","targetRectangle":{"y":808.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2))","targetRectangle":{"y":810.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    # We don't want to force users to call order_cells before even being able","targetRectangle":{"y":814.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    # to look at the trajectory, so check whether it's null and if so, just","targetRectangle":{"y":816.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    # don't color the cells","targetRectangle":{"y":818.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"    if(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\")){","targetRectangle":{"y":820.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"      if (is.null(data_df$cell_color)){","targetRectangle":{"y":822.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"        g <- g + geom_point(color=I(\\\"gray\\\"), size=I(cell_size),","targetRectangle":{"y":824.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":826.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = I(alpha))","targetRectangle":{"y":828.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        message(paste(\\\"cluster_cells() has not been called yet, can't\\\",","targetRectangle":{"y":830.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                      \\\"color cells by cluster\\\"))","targetRectangle":{"y":832.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"      } else{","targetRectangle":{"y":834.00000196695305,"x":362.40000017166153,"width":15.6533203125,"height":2}},{"text":"        g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":836.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":838.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = alpha)","targetRectangle":{"y":840.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"      }","targetRectangle":{"y":842.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":844.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":846.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    } else if (class(data_df$cell_color) == \\\"numeric\\\"){","targetRectangle":{"y":848.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":850.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":852.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + viridis::scale_color_viridis(name = color_cells_by, option=\\\"C\\\")","targetRectangle":{"y":854.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"    } else {","targetRectangle":{"y":856.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":858.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":860.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":862.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":864.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    }","targetRectangle":{"y":866.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":870.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (show_trajectory_graph){","targetRectangle":{"y":872.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"    g <- g + geom_segment(aes_string(x=\\\"source_prin_graph_dim_1\\\",","targetRectangle":{"y":874.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     y=\\\"source_prin_graph_dim_2\\\",","targetRectangle":{"y":876.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     xend=\\\"target_prin_graph_dim_1\\\",","targetRectangle":{"y":878.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     yend=\\\"target_prin_graph_dim_2\\\"),","targetRectangle":{"y":880.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          size=trajectory_graph_segment_size,","targetRectangle":{"y":882.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"                          color=I(trajectory_graph_color),","targetRectangle":{"y":884.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          linetype=\\\"solid\\\",","targetRectangle":{"y":886.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"                          na.rm=TRUE,","targetRectangle":{"y":888.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"                          data=edge_df)","targetRectangle":{"y":890.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"    if (label_branch_points){","targetRectangle":{"y":896.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"      mst_branch_nodes <- branch_nodes(cds)","targetRectangle":{"y":898.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"      branch_point_df <- ica_space_df %>%","targetRectangle":{"y":900.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"        dplyr::slice(match(names(mst_branch_nodes), sample_name)) %>%","targetRectangle":{"y":902.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        dplyr::mutate(branch_point_idx = seq_len(dplyr::n()))","targetRectangle":{"y":904.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":908.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":910.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":912.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"white\\\",","targetRectangle":{"y":914.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"black\\\",","targetRectangle":{"y":916.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":918.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE, branch_point_df) +","targetRectangle":{"y":920.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":922.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"branch_point_idx\\\"),","targetRectangle":{"y":924.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"white\\\", na.rm=TRUE,","targetRectangle":{"y":926.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                  branch_point_df)","targetRectangle":{"y":928.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"    }","targetRectangle":{"y":930.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_leaves){","targetRectangle":{"y":934.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"      mst_leaf_nodes <- leaf_nodes(cds)","targetRectangle":{"y":936.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      leaf_df <- ica_space_df %>%","targetRectangle":{"y":938.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_leaf_nodes), sample_name)) %>%","targetRectangle":{"y":940.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(leaf_idx = seq_len(dplyr::n()))","targetRectangle":{"y":942.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":946.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":948.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":950.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":952.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"lightgray\\\",","targetRectangle":{"y":954.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":956.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":958.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   leaf_df) +","targetRectangle":{"y":960.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":962.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"leaf_idx\\\"),","targetRectangle":{"y":964.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, leaf_df)","targetRectangle":{"y":966.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":968.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_roots){","targetRectangle":{"y":972.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"      mst_root_nodes <- root_nodes(cds)","targetRectangle":{"y":974.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      root_df <- ica_space_df %>%","targetRectangle":{"y":976.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_root_nodes), sample_name)) %>%","targetRectangle":{"y":978.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(root_idx = seq_len(dplyr::n()))","targetRectangle":{"y":980.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":984.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":986.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":988.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":990.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"white\\\",","targetRectangle":{"y":992.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":994.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":996.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   root_df) +","targetRectangle":{"y":998.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":1000.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"root_idx\\\"),","targetRectangle":{"y":1002.0000019669531,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, root_df)","targetRectangle":{"y":1004.0000019669531,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":1006.0000019669531,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":1008.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if(label_cell_groups) {","targetRectangle":{"y":1012.0000019669531,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":1014.0000019669531,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":1016.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":1018.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":1020.0000019669531,"x":362.40000017166153,"width":91.51171875,"height":2}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":1022.0000019669531,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":1024.0000019669531,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":1026.0000019669531,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":1028.0000019669531,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"  }","targetRectangle":{"y":1030.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  g <- g +","targetRectangle":{"y":1034.0000019669531,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    #scale_color_brewer(palette=\\\"Set1\\\") +","targetRectangle":{"y":1036.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    monocle_theme_opts() +","targetRectangle":{"y":1038.0000019669531,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"    xlab(paste(reduction_method, x)) +","targetRectangle":{"y":1040.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    ylab(paste(reduction_method, y)) +","targetRectangle":{"y":1042.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    #guides(color = guide_legend(label.position = \\\"top\\\")) +","targetRectangle":{"y":1044.0000019669531,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"    theme(legend.key = element_blank()) +","targetRectangle":{"y":1046.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    theme(panel.background = element_rect(fill='white'))","targetRectangle":{"y":1048.0000019669531,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  g","targetRectangle":{"y":1050.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"}","targetRectangle":{"y":1052.0000019669531,"x":362.40000017166153,"width":1.2041015625,"height":2}},{"text":"plot_cells() from Monocle 3:","targetRectangle":{"y":161.14727131345103,"x":69.851549236991204,"width":235.50550781250001,"height":71.160003662109375}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":1,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"C25C25FF361FB24FC35F6B120D2F252D"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":614,"pointY":59},"width":962,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":62,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.53987096774193555,"textBaseline":0.76631804435483875,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":829,"pointY":98},"width":962,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":62,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"7E09CED92E23CCF90CE5B16A90602C55"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":443.90000017166153,"pointY":606.00000196695305},"width":171,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":896,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.001220703125,"textBaseline":1.0017057168297467,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":88.099999828338468,"pointY":449.99999803304695},"width":171,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":896,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"4296E54C45A6264715204297D66D6DCA"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":811.56660199972066,"pointY":913.86364841461182},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":205,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"3C5A5888-64C5-45F0-A79D-ADC6AC019884","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":324.43339800027934,"pointY":101.13635158538818},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":205,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"7C4E1F6010CEF29B83A62B7813154690"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":897.88557350852261,"pointY":501.11730846058242},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":423,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"6DAF87A0-34ED-4E19-8651-E6E8EAC16CF8","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":262.11442649147739,"pointY":209.88269153941758},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":423,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BC3F5294029FE4948FE58D45307782EE"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1548.9530545321365,"pointY":488.12738009366115},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":448,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"15A40B61-3DFA-471A-B88B-FB019431093D","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":278.04694546786345,"pointY":222.87261990633885},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":448,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BAC3B18083DD6755EA1FCCE1B75491C1"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":153.2666029479287,"pointY":187.14727131345103},"width":222,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":60,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.228271484375,"textBaseline":0.94862253133095464,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":136.7333970520713,"pointY":41.852728686548971},"width":222,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":60,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"68CD03AE3BD9EE91E8954131BBB0167E"}]}]}]}},{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":897.88557350852261,"pointY":501.11730846058242},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":423,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"6DAF87A0-34ED-4E19-8651-E6E8EAC16CF8","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":326.11442649147739,"pointY":250.38269153941758},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":423,"hidden":false,"anchorPoint":{"pointX":0.61764095926416174,"pointY":0.59192125659436778}},"layers":[{"animations":[{"timeOffset":0,"beginTime":1e-100,"repeatCount":0,"animations":[{"timeOffset":0,"from":{"scalar":true},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.0001,"to":{"scalar":false}},{"timeOffset":0,"from":{"scalar":false},"beginTime":0.0001,"repeatCount":0,"fillMode":"forwards","property":"hidden","autoreverses":false,"duration":0.0099000000000000008,"to":{"scalar":false}}],"fillMode":"both","autoreverses":false,"duration":0.01}],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":262.11442649147739,"pointY":209.88269153941758},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":423,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BC3F5294029FE4948FE58D45307782EE"}]}]},"effects":[],"duration":0.01,"type":"buildIn","attributes":{"direction":0},"name":"apple:appear","objectID":"6DAF87A0-34ED-4E19-8651-E6E8EAC16CF8"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Plots can be built programmatically","targetRectangle":{"y":80,"x":478.11200000000002,"width":963.77599999999984,"height":76.1435546875}},{"text":"if(label_cell_groups) {","targetRectangle":{"y":815.36364841461182,"x":580.76361083984375,"width":166.166015625,"height":18}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":833.36364841461182,"x":580.76361083984375,"width":382.904296875,"height":18}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":851.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":869.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":887.36364841461182,"x":580.76361083984375,"width":549.0703125,"height":18}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":905.36364841461182,"x":580.76361083984375,"width":455.150390625,"height":18}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":923.36364841461182,"x":580.76361083984375,"width":469.599609375,"height":18}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":941.36364841461182,"x":580.76361083984375,"width":223.962890625,"height":18}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":959.36364841461182,"x":580.76361083984375,"width":317.8828125,"height":18}},{"text":"  }","targetRectangle":{"y":977.36364841461182,"x":580.76361083984375,"width":21.673828125,"height":18}},{"text":"plot_cells <- function(cds,","targetRectangle":{"y":162.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       x=1,","targetRectangle":{"y":164.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       y=2,","targetRectangle":{"y":166.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       reduction_method = c(\\\"UMAP\\\", \\\"tSNE\\\", \\\"PCA\\\", \\\"LSI\\\", \\\"Aligned\\\"),","targetRectangle":{"y":168.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                       color_cells_by=\\\"cluster\\\",","targetRectangle":{"y":170.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       group_cells_by=c(\\\"cluster\\\", \\\"partition\\\"),","targetRectangle":{"y":172.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                       genes=NULL,","targetRectangle":{"y":174.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"                       show_trajectory_graph=TRUE,","targetRectangle":{"y":176.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                       trajectory_graph_color=\\\"grey28\\\",","targetRectangle":{"y":178.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                       trajectory_graph_segment_size=0.75,","targetRectangle":{"y":180.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                       norm_method = c(\\\"log\\\", \\\"size_only\\\"),","targetRectangle":{"y":182.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"                       label_cell_groups = TRUE,","targetRectangle":{"y":184.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_groups_by_cluster=TRUE,","targetRectangle":{"y":186.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"                       group_label_size=2,","targetRectangle":{"y":188.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       labels_per_group=1,","targetRectangle":{"y":190.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       label_branch_points=TRUE,","targetRectangle":{"y":192.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_roots=TRUE,","targetRectangle":{"y":194.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                       label_leaves=TRUE,","targetRectangle":{"y":196.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"                       graph_label_size=2,","targetRectangle":{"y":198.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       cell_size=0.35,","targetRectangle":{"y":200.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"                       cell_stroke= I(cell_size \/ 2),","targetRectangle":{"y":202.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                       alpha = 1,","targetRectangle":{"y":204.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                       min_expr=0.1,","targetRectangle":{"y":206.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                       rasterize=FALSE,","targetRectangle":{"y":208.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                       scale_to_range=FALSE) {","targetRectangle":{"y":210.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"  reduction_method <- match.arg(reduction_method)","targetRectangle":{"y":212.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"  assertthat::assert_that(methods::is(cds, \\\"cell_data_set\\\"))","targetRectangle":{"y":214.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"  assertthat::assert_that(!is.null(reducedDims(cds)[[reduction_method]]),","targetRectangle":{"y":216.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                          msg = paste(\\\"No dimensionality reduction for\\\",","targetRectangle":{"y":218.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                      reduction_method, \\\"calculated.\\\",","targetRectangle":{"y":220.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                                      \\\"Please run reduce_dimensions with\\\",","targetRectangle":{"y":222.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                      \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":224.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"                                      \\\"before attempting to plot.\\\"))","targetRectangle":{"y":226.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"  low_dim_coords <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":228.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  assertthat::assert_that(ncol(low_dim_coords) >=max(x,y),","targetRectangle":{"y":230.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          msg = paste(\\\"x and\/or y is too large. x and y must\\\",","targetRectangle":{"y":232.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be dimensions in reduced dimension\\\",","targetRectangle":{"y":234.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"                                      \\\"space.\\\"))","targetRectangle":{"y":236.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"  if(!is.null(color_cells_by)) {","targetRectangle":{"y":238.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"    assertthat::assert_that(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\",","targetRectangle":{"y":240.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                                                  \\\"pseudotime\\\") |","targetRectangle":{"y":242.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                              color_cells_by %in% names(colData(cds)),","targetRectangle":{"y":244.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            msg = paste(\\\"color_cells_by must one of\\\",","targetRectangle":{"y":246.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                        \\\"'cluster', 'partition', 'pseudotime,\\\",","targetRectangle":{"y":248.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                        \\\"or a column in the colData table.\\\"))","targetRectangle":{"y":250.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    if(color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":254.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      tryCatch({pseudotime(cds, reduction_method = reduction_method)},","targetRectangle":{"y":256.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"               error = function(x) {","targetRectangle":{"y":258.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                 stop(paste(\\\"No pseudotime for\\\", reduction_method,","targetRectangle":{"y":260.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            \\\"calculated. Please run order_cells with\\\",","targetRectangle":{"y":262.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":264.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"                            \\\"before attempting to color by pseudotime.\\\"))})","targetRectangle":{"y":266.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    }","targetRectangle":{"y":270.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":272.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(markers),","targetRectangle":{"y":274.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or markers must\\\",","targetRectangle":{"y":276.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be NULL, cannot color by both!\\\"))","targetRectangle":{"y":278.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"  norm_method = match.arg(norm_method)","targetRectangle":{"y":282.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"  group_cells_by=match.arg(group_cells_by)","targetRectangle":{"y":284.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(genes),","targetRectangle":{"y":286.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or genes must be\\\",","targetRectangle":{"y":288.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                      \\\"NULL, cannot color by both!\\\"))","targetRectangle":{"y":290.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"  if (show_trajectory_graph &&","targetRectangle":{"y":294.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"      is.null(principal_graph(cds)[[reduction_method]])) {","targetRectangle":{"y":296.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    message(\\\"No trajectory to plot. Has learn_graph() been called yet?\\\")","targetRectangle":{"y":298.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    show_trajectory_graph = FALSE","targetRectangle":{"y":300.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  }","targetRectangle":{"y":302.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  gene_short_name <- NA","targetRectangle":{"y":306.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  sample_name <- NA","targetRectangle":{"y":308.00000196695305,"x":362.40000017166153,"width":22.8779296875,"height":2}},{"text":"  #sample_state <- colData(cds)$State","targetRectangle":{"y":310.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  data_dim_1 <- NA","targetRectangle":{"y":312.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  data_dim_2 <- NA","targetRectangle":{"y":314.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  if (rasterize){","targetRectangle":{"y":316.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"    plotting_func <- ggrastr::geom_point_rast","targetRectangle":{"y":318.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"  }else{","targetRectangle":{"y":320.00000196695305,"x":362.40000017166153,"width":9.6328125,"height":2}},{"text":"    plotting_func <- ggplot2::geom_point","targetRectangle":{"y":322.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"  }","targetRectangle":{"y":324.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  S_matrix <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":328.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"  data_df <- data.frame(S_matrix[,c(x,y)])","targetRectangle":{"y":330.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  colnames(data_df) <- c(\\\"data_dim_1\\\", \\\"data_dim_2\\\")","targetRectangle":{"y":334.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"  data_df$sample_name <- row.names(data_df)","targetRectangle":{"y":336.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"  data_df <- as.data.frame(cbind(data_df, colData(cds)))","targetRectangle":{"y":340.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  if (group_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":342.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":344.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":346.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":348.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":350.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":352.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (group_cells_by == \\\"partition\\\") {","targetRectangle":{"y":354.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":356.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":358.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":360.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":362.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":364.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else{","targetRectangle":{"y":366.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    stop(\\\"Error: unrecognized way of grouping cells.\\\")","targetRectangle":{"y":368.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"  }","targetRectangle":{"y":370.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (color_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":374.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":376.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":378.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":380.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":382.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":384.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"partition\\\") {","targetRectangle":{"y":386.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":388.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":390.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":392.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":394.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":396.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":398.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":400.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({pseudotime(cds,","targetRectangle":{"y":402.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":404.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]}, error = function(e) {NULL})","targetRectangle":{"y":406.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"  } else{","targetRectangle":{"y":408.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    data_df$cell_color <- colData(cds)[data_df$sample_name,color_cells_by]","targetRectangle":{"y":410.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"  }","targetRectangle":{"y":412.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Graph info","targetRectangle":{"y":416.00000196695305,"x":362.40000017166153,"width":18.0615234375,"height":2}},{"text":"  if (show_trajectory_graph) {","targetRectangle":{"y":418.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"    ica_space_df <- t(cds@principal_graph_aux[[reduction_method]]$dp_mst) %>%","targetRectangle":{"y":422.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"      as.data.frame() %>%","targetRectangle":{"y":424.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      dplyr::select_(prin_graph_dim_1 = x, prin_graph_dim_2 = y) %>%","targetRectangle":{"y":426.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      dplyr::mutate(sample_name = rownames(.),","targetRectangle":{"y":428.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"                    sample_state = rownames(.))","targetRectangle":{"y":430.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"    dp_mst <- cds@principal_graph[[reduction_method]]","targetRectangle":{"y":434.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"    edge_df <- dp_mst %>%","targetRectangle":{"y":438.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      igraph::as_data_frame() %>%","targetRectangle":{"y":440.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      dplyr::select_(source = \\\"from\\\", target = \\\"to\\\") %>%","targetRectangle":{"y":442.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":444.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":446.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           source=\\\"sample_name\\\",","targetRectangle":{"y":448.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           source_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":450.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           source_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":452.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"source\\\") %>%","targetRectangle":{"y":454.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":456.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":458.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           target=\\\"sample_name\\\",","targetRectangle":{"y":460.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           target_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":462.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           target_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":464.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"target\\\")","targetRectangle":{"y":466.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  }","targetRectangle":{"y":468.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Marker genes","targetRectangle":{"y":472.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"  markers_exprs <- NULL","targetRectangle":{"y":474.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  expression_legend_label <- NULL","targetRectangle":{"y":476.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  if (!is.null(genes)) {","targetRectangle":{"y":478.00000196695305,"x":362.40000017166153,"width":28.8984375,"height":2}},{"text":"    if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":480.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"      markers = unlist(genes[,1], use.names=FALSE)","targetRectangle":{"y":482.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"    } else {","targetRectangle":{"y":484.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      markers = genes","targetRectangle":{"y":486.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"    }","targetRectangle":{"y":488.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    markers_rowData <- as.data.frame(subset(rowData(cds),","targetRectangle":{"y":490.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                                            gene_short_name %in% markers |","targetRectangle":{"y":492.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              row.names(rowData(cds)) %in%","targetRectangle":{"y":494.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              markers))","targetRectangle":{"y":496.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"    if (nrow(markers_rowData) == 0) {","targetRectangle":{"y":498.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      stop(\\\"None of the provided genes were found in the cds\\\")","targetRectangle":{"y":500.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    }","targetRectangle":{"y":502.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (nrow(markers_rowData) >= 1) {","targetRectangle":{"y":504.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      cds_exprs <- SingleCellExperiment::counts(cds)[row.names(markers_rowData), ,drop=FALSE]","targetRectangle":{"y":506.00000196695305,"x":362.40000017166153,"width":111.9814453125,"height":2}},{"text":"      cds_exprs <- Matrix::t(Matrix::t(cds_exprs)\/size_factors(cds))","targetRectangle":{"y":508.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":512.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"        genes = as.data.frame(genes)","targetRectangle":{"y":514.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        row.names(genes) = genes[,1]","targetRectangle":{"y":516.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        genes = genes[row.names(cds_exprs),]","targetRectangle":{"y":518.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"        agg_mat = as.matrix(aggregate_gene_expression(cds, genes, norm_method=norm_method, scale_agg_values=FALSE))","targetRectangle":{"y":522.00000196695305,"x":362.40000017166153,"width":138.4716796875,"height":2}},{"text":"        markers_exprs = agg_mat","targetRectangle":{"y":524.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":526.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":528.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        if (is.factor(genes[,2]))","targetRectangle":{"y":530.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"          markers_exprs$feature_id = factor(markers_exprs$feature_id,","targetRectangle":{"y":532.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                            levels=levels(genes[,2]))","targetRectangle":{"y":534.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        markers_exprs$feature_label <- markers_exprs$feature_id","targetRectangle":{"y":538.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        norm_method = \\\"size_only\\\"","targetRectangle":{"y":540.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        expression_legend_label = \\\"Expression score\\\"","targetRectangle":{"y":542.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"      } else {","targetRectangle":{"y":544.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        cds_exprs@x = round(10000*cds_exprs@x)\/10000","targetRectangle":{"y":546.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        markers_exprs = matrix(cds_exprs, nrow=nrow(markers_rowData))","targetRectangle":{"y":548.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        colnames(markers_exprs) = colnames(SingleCellExperiment::counts(cds))","targetRectangle":{"y":550.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        row.names(markers_exprs) = row.names(markers_rowData)","targetRectangle":{"y":552.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":554.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":556.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        markers_exprs <- merge(markers_exprs, markers_rowData,","targetRectangle":{"y":558.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                               by.x = \\\"feature_id\\\", by.y=\\\"row.names\\\")","targetRectangle":{"y":560.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        if (is.null(markers_exprs$gene_short_name)) {","targetRectangle":{"y":562.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":564.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$feature_id)","targetRectangle":{"y":566.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        } else {","targetRectangle":{"y":568.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":570.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$gene_short_name)","targetRectangle":{"y":572.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"        }","targetRectangle":{"y":574.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        markers_exprs$feature_label <- ifelse(is.na(markers_exprs$feature_label) | !as.character(markers_exprs$feature_label) %in% markers,","targetRectangle":{"y":578.00000196695305,"x":362.40000017166153,"width":167.3701171875,"height":2}},{"text":"                                              as.character(markers_exprs$feature_id),","targetRectangle":{"y":580.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                                              as.character(markers_exprs$feature_label))","targetRectangle":{"y":582.00000196695305,"x":362.40000017166153,"width":105.9609375,"height":2}},{"text":"        markers_exprs$feature_label <- factor(markers_exprs$feature_label,","targetRectangle":{"y":586.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              levels = markers)","targetRectangle":{"y":588.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        if (norm_method == \\\"size_only\\\")","targetRectangle":{"y":590.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"          expression_legend_label = \\\"Expression\\\"","targetRectangle":{"y":592.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        else","targetRectangle":{"y":594.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"          expression_legend_label = \\\"log10(Expression)\\\"","targetRectangle":{"y":596.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      }","targetRectangle":{"y":598.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      if (scale_to_range){","targetRectangle":{"y":602.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        markers_exprs = dplyr::group_by(markers_exprs, feature_label) %>%","targetRectangle":{"y":604.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"          dplyr::mutate(max_val_for_feature = max(value),","targetRectangle":{"y":606.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                        min_val_for_feature = min(value)) %>%","targetRectangle":{"y":608.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"          dplyr::mutate(value = 100 * (value - min_val_for_feature) \/ (max_val_for_feature - min_val_for_feature))","targetRectangle":{"y":610.00000196695305,"x":362.40000017166153,"width":137.267578125,"height":2}},{"text":"        expression_legend_label = \\\"% Max\\\"","targetRectangle":{"y":612.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      }","targetRectangle":{"y":614.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":616.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":618.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (label_cell_groups && is.null(color_cells_by) == FALSE){","targetRectangle":{"y":622.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"    if (is.null(data_df$cell_color)){","targetRectangle":{"y":624.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      if (is.null(genes)){","targetRectangle":{"y":626.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        message(paste(color_cells_by, \\\"not found in colData(cds), cells will\\\",","targetRectangle":{"y":628.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                      \\\"not be colored\\\"))","targetRectangle":{"y":630.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      }","targetRectangle":{"y":632.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      text_df = NULL","targetRectangle":{"y":634.00000196695305,"x":362.40000017166153,"width":24.08203125,"height":2}},{"text":"      label_cell_groups = FALSE","targetRectangle":{"y":636.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"    }else{","targetRectangle":{"y":638.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"      if(is.character(data_df$cell_color) || is.factor(data_df$cell_color)) {","targetRectangle":{"y":640.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        if (label_groups_by_cluster && is.null(data_df$cell_group) == FALSE){","targetRectangle":{"y":644.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"          text_df = data_df %>%","targetRectangle":{"y":646.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"            dplyr::group_by(cell_group) %>%","targetRectangle":{"y":648.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"            dplyr::mutate(cells_in_cluster= dplyr::n()) %>%","targetRectangle":{"y":650.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"            dplyr::group_by(cell_color, add=TRUE) %>%","targetRectangle":{"y":652.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"            dplyr::mutate(per=dplyr::n()\/cells_in_cluster)","targetRectangle":{"y":654.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":656.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":658.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":660.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":662.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":664.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":666.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":668.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":670.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_group) %>%","targetRectangle":{"y":672.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":674.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        } else {","targetRectangle":{"y":676.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          text_df = data_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":678.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::mutate(per=1)","targetRectangle":{"y":680.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":682.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":684.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":686.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":688.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":690.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":692.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":694.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":696.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":698.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":700.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        }","targetRectangle":{"y":702.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        text_df$label = as.character(text_df %>% dplyr::pull(cell_color))","targetRectangle":{"y":706.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"        # I feel like there's probably a good reason for the bit below, but I","targetRectangle":{"y":708.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        # hate it and I'm killing it for now.","targetRectangle":{"y":710.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        # text_df$label <- paste0(1:nrow(text_df))","targetRectangle":{"y":712.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        # text_df$process_label <- paste0(1:nrow(text_df), '_',","targetRectangle":{"y":714.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        # as.character(as.matrix(text_df[, 1])))","targetRectangle":{"y":716.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # process_label <- text_df$process_label","targetRectangle":{"y":718.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # names(process_label) <- as.character(as.matrix(text_df[, 1]))","targetRectangle":{"y":720.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"        # data_df[, group_by] <-","targetRectangle":{"y":722.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"        #  process_label[as.character(data_df[, group_by])]","targetRectangle":{"y":724.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"        # text_df$label = process_label","targetRectangle":{"y":726.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      } else {","targetRectangle":{"y":728.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        message(paste(\\\"Cells aren't colored in a way that allows them to\\\",","targetRectangle":{"y":730.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                      \\\"be grouped.\\\"))","targetRectangle":{"y":732.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"        text_df = NULL","targetRectangle":{"y":734.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"        label_cell_groups = FALSE","targetRectangle":{"y":736.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      }","targetRectangle":{"y":738.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":740.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":742.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (!is.null(markers_exprs) && nrow(markers_exprs) > 0){","targetRectangle":{"y":746.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    data_df <- merge(data_df, markers_exprs, by.x=\\\"sample_name\\\",","targetRectangle":{"y":748.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                     by.y=\\\"cell_id\\\")","targetRectangle":{"y":750.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"    data_df$value <- with(data_df, ifelse(value >= min_expr, value, NA))","targetRectangle":{"y":752.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    na_sub <- data_df[is.na(data_df$value),]","targetRectangle":{"y":754.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"    if(norm_method == \\\"size_only\\\"){","targetRectangle":{"y":756.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":758.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":760.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\", alpha = alpha,","targetRectangle":{"y":762.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                      data = na_sub) +","targetRectangle":{"y":764.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"        plotting_func(aes(color=value), size=I(cell_size),","targetRectangle":{"y":766.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                      stroke = I(cell_stroke), na.rm = TRUE) +","targetRectangle":{"y":768.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":770.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":772.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":774.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":776.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":778.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    } else {","targetRectangle":{"y":780.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":782.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":784.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\",","targetRectangle":{"y":786.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                      data = na_sub, alpha = alpha) +","targetRectangle":{"y":788.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        plotting_func(aes(color=log10(value+min_expr)),","targetRectangle":{"y":790.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                      size=I(cell_size), stroke = I(cell_stroke),","targetRectangle":{"y":792.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                      na.rm = TRUE, alpha = alpha) +","targetRectangle":{"y":794.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":796.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":798.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":800.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":802.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":804.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    }","targetRectangle":{"y":806.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  } else {","targetRectangle":{"y":808.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2))","targetRectangle":{"y":810.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    # We don't want to force users to call order_cells before even being able","targetRectangle":{"y":814.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    # to look at the trajectory, so check whether it's null and if so, just","targetRectangle":{"y":816.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    # don't color the cells","targetRectangle":{"y":818.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"    if(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\")){","targetRectangle":{"y":820.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"      if (is.null(data_df$cell_color)){","targetRectangle":{"y":822.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"        g <- g + geom_point(color=I(\\\"gray\\\"), size=I(cell_size),","targetRectangle":{"y":824.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":826.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = I(alpha))","targetRectangle":{"y":828.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        message(paste(\\\"cluster_cells() has not been called yet, can't\\\",","targetRectangle":{"y":830.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                      \\\"color cells by cluster\\\"))","targetRectangle":{"y":832.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"      } else{","targetRectangle":{"y":834.00000196695305,"x":362.40000017166153,"width":15.6533203125,"height":2}},{"text":"        g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":836.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":838.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = alpha)","targetRectangle":{"y":840.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"      }","targetRectangle":{"y":842.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":844.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":846.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    } else if (class(data_df$cell_color) == \\\"numeric\\\"){","targetRectangle":{"y":848.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":850.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":852.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + viridis::scale_color_viridis(name = color_cells_by, option=\\\"C\\\")","targetRectangle":{"y":854.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"    } else {","targetRectangle":{"y":856.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":858.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":860.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":862.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":864.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    }","targetRectangle":{"y":866.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":870.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (show_trajectory_graph){","targetRectangle":{"y":872.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"    g <- g + geom_segment(aes_string(x=\\\"source_prin_graph_dim_1\\\",","targetRectangle":{"y":874.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     y=\\\"source_prin_graph_dim_2\\\",","targetRectangle":{"y":876.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     xend=\\\"target_prin_graph_dim_1\\\",","targetRectangle":{"y":878.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     yend=\\\"target_prin_graph_dim_2\\\"),","targetRectangle":{"y":880.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          size=trajectory_graph_segment_size,","targetRectangle":{"y":882.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"                          color=I(trajectory_graph_color),","targetRectangle":{"y":884.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          linetype=\\\"solid\\\",","targetRectangle":{"y":886.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"                          na.rm=TRUE,","targetRectangle":{"y":888.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"                          data=edge_df)","targetRectangle":{"y":890.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"    if (label_branch_points){","targetRectangle":{"y":896.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"      mst_branch_nodes <- branch_nodes(cds)","targetRectangle":{"y":898.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"      branch_point_df <- ica_space_df %>%","targetRectangle":{"y":900.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"        dplyr::slice(match(names(mst_branch_nodes), sample_name)) %>%","targetRectangle":{"y":902.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        dplyr::mutate(branch_point_idx = seq_len(dplyr::n()))","targetRectangle":{"y":904.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":908.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":910.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":912.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"white\\\",","targetRectangle":{"y":914.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"black\\\",","targetRectangle":{"y":916.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":918.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE, branch_point_df) +","targetRectangle":{"y":920.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":922.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"branch_point_idx\\\"),","targetRectangle":{"y":924.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"white\\\", na.rm=TRUE,","targetRectangle":{"y":926.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                  branch_point_df)","targetRectangle":{"y":928.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"    }","targetRectangle":{"y":930.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_leaves){","targetRectangle":{"y":934.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"      mst_leaf_nodes <- leaf_nodes(cds)","targetRectangle":{"y":936.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      leaf_df <- ica_space_df %>%","targetRectangle":{"y":938.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_leaf_nodes), sample_name)) %>%","targetRectangle":{"y":940.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(leaf_idx = seq_len(dplyr::n()))","targetRectangle":{"y":942.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":946.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":948.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":950.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":952.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"lightgray\\\",","targetRectangle":{"y":954.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":956.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":958.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   leaf_df) +","targetRectangle":{"y":960.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":962.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"leaf_idx\\\"),","targetRectangle":{"y":964.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, leaf_df)","targetRectangle":{"y":966.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":968.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_roots){","targetRectangle":{"y":972.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"      mst_root_nodes <- root_nodes(cds)","targetRectangle":{"y":974.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      root_df <- ica_space_df %>%","targetRectangle":{"y":976.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_root_nodes), sample_name)) %>%","targetRectangle":{"y":978.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(root_idx = seq_len(dplyr::n()))","targetRectangle":{"y":980.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":984.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":986.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":988.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":990.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"white\\\",","targetRectangle":{"y":992.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":994.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":996.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   root_df) +","targetRectangle":{"y":998.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":1000.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"root_idx\\\"),","targetRectangle":{"y":1002.0000019669531,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, root_df)","targetRectangle":{"y":1004.0000019669531,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":1006.0000019669531,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":1008.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if(label_cell_groups) {","targetRectangle":{"y":1012.0000019669531,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":1014.0000019669531,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":1016.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":1018.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":1020.0000019669531,"x":362.40000017166153,"width":91.51171875,"height":2}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":1022.0000019669531,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":1024.0000019669531,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":1026.0000019669531,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":1028.0000019669531,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"  }","targetRectangle":{"y":1030.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  g <- g +","targetRectangle":{"y":1034.0000019669531,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    #scale_color_brewer(palette=\\\"Set1\\\") +","targetRectangle":{"y":1036.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    monocle_theme_opts() +","targetRectangle":{"y":1038.0000019669531,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"    xlab(paste(reduction_method, x)) +","targetRectangle":{"y":1040.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    ylab(paste(reduction_method, y)) +","targetRectangle":{"y":1042.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    #guides(color = guide_legend(label.position = \\\"top\\\")) +","targetRectangle":{"y":1044.0000019669531,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"    theme(legend.key = element_blank()) +","targetRectangle":{"y":1046.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    theme(panel.background = element_rect(fill='white'))","targetRectangle":{"y":1048.0000019669531,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  g","targetRectangle":{"y":1050.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"}","targetRectangle":{"y":1052.0000019669531,"x":362.40000017166153,"width":1.2041015625,"height":2}},{"text":"plot_cells() from Monocle 3:","targetRectangle":{"y":161.14727131345103,"x":69.851549236991204,"width":235.50550781250001,"height":71.160003662109375}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":1,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"C25C25FF361FB24FC35F6B120D2F252D"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":614,"pointY":59},"width":962,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":62,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.53987096774193555,"textBaseline":0.76631804435483875,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":829,"pointY":98},"width":962,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":62,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"7E09CED92E23CCF90CE5B16A90602C55"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":443.90000017166153,"pointY":606.00000196695305},"width":171,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":896,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.001220703125,"textBaseline":1.0017057168297467,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":88.099999828338468,"pointY":449.99999803304695},"width":171,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":896,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"4296E54C45A6264715204297D66D6DCA"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":811.56660199972066,"pointY":913.86364841461182},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":205,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"3C5A5888-64C5-45F0-A79D-ADC6AC019884","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":324.43339800027934,"pointY":101.13635158538818},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":205,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"7C4E1F6010CEF29B83A62B7813154690"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":897.88557350852261,"pointY":501.11730846058242},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":423,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"6DAF87A0-34ED-4E19-8651-E6E8EAC16CF8","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":262.11442649147739,"pointY":209.88269153941758},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":423,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BC3F5294029FE4948FE58D45307782EE"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1548.9530545321365,"pointY":488.12738009366115},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":448,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"15A40B61-3DFA-471A-B88B-FB019431093D","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":278.04694546786345,"pointY":222.87261990633885},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":448,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BAC3B18083DD6755EA1FCCE1B75491C1"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":153.2666029479287,"pointY":187.14727131345103},"width":222,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":60,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.228271484375,"textBaseline":0.94862253133095464,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":136.7333970520713,"pointY":41.852728686548971},"width":222,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":60,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"68CD03AE3BD9EE91E8954131BBB0167E"}]}]}]}},{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1548.9530545321365,"pointY":488.12738009366115},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":448,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"15A40B61-3DFA-471A-B88B-FB019431093D","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":-308.95305453213655,"pointY":275.87261990633885},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":448,"hidden":false,"anchorPoint":{"pointX":-0.55170188309310098,"pointY":0.61578709800522069}},"layers":[{"animations":[{"timeOffset":0,"beginTime":1e-100,"repeatCount":0,"animations":[{"timeOffset":0,"from":{"scalar":true},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.0001,"to":{"scalar":false}},{"timeOffset":0,"from":{"scalar":false},"beginTime":0.0001,"repeatCount":0,"fillMode":"forwards","property":"hidden","autoreverses":false,"duration":0.0099000000000000008,"to":{"scalar":false}}],"fillMode":"both","autoreverses":false,"duration":0.01}],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":278.04694546786345,"pointY":222.87261990633885},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":448,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BAC3B18083DD6755EA1FCCE1B75491C1"}]}]},"effects":[],"duration":0.01,"type":"buildIn","attributes":{"direction":0},"name":"apple:appear","objectID":"15A40B61-3DFA-471A-B88B-FB019431093D"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Plots can be built programmatically","targetRectangle":{"y":80,"x":478.11200000000002,"width":963.77599999999984,"height":76.1435546875}},{"text":"if(label_cell_groups) {","targetRectangle":{"y":815.36364841461182,"x":580.76361083984375,"width":166.166015625,"height":18}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":833.36364841461182,"x":580.76361083984375,"width":382.904296875,"height":18}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":851.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":869.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":887.36364841461182,"x":580.76361083984375,"width":549.0703125,"height":18}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":905.36364841461182,"x":580.76361083984375,"width":455.150390625,"height":18}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":923.36364841461182,"x":580.76361083984375,"width":469.599609375,"height":18}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":941.36364841461182,"x":580.76361083984375,"width":223.962890625,"height":18}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":959.36364841461182,"x":580.76361083984375,"width":317.8828125,"height":18}},{"text":"  }","targetRectangle":{"y":977.36364841461182,"x":580.76361083984375,"width":21.673828125,"height":18}},{"text":"pasted-image.tiff","targetRectangle":{"y":289.61730846058242,"x":633.88557350852261,"width":524.76556396484375,"height":419.81240844726574}},{"text":"plot_cells <- function(cds,","targetRectangle":{"y":162.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       x=1,","targetRectangle":{"y":164.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       y=2,","targetRectangle":{"y":166.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       reduction_method = c(\\\"UMAP\\\", \\\"tSNE\\\", \\\"PCA\\\", \\\"LSI\\\", \\\"Aligned\\\"),","targetRectangle":{"y":168.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                       color_cells_by=\\\"cluster\\\",","targetRectangle":{"y":170.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       group_cells_by=c(\\\"cluster\\\", \\\"partition\\\"),","targetRectangle":{"y":172.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                       genes=NULL,","targetRectangle":{"y":174.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"                       show_trajectory_graph=TRUE,","targetRectangle":{"y":176.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                       trajectory_graph_color=\\\"grey28\\\",","targetRectangle":{"y":178.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                       trajectory_graph_segment_size=0.75,","targetRectangle":{"y":180.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                       norm_method = c(\\\"log\\\", \\\"size_only\\\"),","targetRectangle":{"y":182.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"                       label_cell_groups = TRUE,","targetRectangle":{"y":184.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_groups_by_cluster=TRUE,","targetRectangle":{"y":186.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"                       group_label_size=2,","targetRectangle":{"y":188.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       labels_per_group=1,","targetRectangle":{"y":190.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       label_branch_points=TRUE,","targetRectangle":{"y":192.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_roots=TRUE,","targetRectangle":{"y":194.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                       label_leaves=TRUE,","targetRectangle":{"y":196.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"                       graph_label_size=2,","targetRectangle":{"y":198.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       cell_size=0.35,","targetRectangle":{"y":200.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"                       cell_stroke= I(cell_size \/ 2),","targetRectangle":{"y":202.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                       alpha = 1,","targetRectangle":{"y":204.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                       min_expr=0.1,","targetRectangle":{"y":206.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                       rasterize=FALSE,","targetRectangle":{"y":208.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                       scale_to_range=FALSE) {","targetRectangle":{"y":210.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"  reduction_method <- match.arg(reduction_method)","targetRectangle":{"y":212.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"  assertthat::assert_that(methods::is(cds, \\\"cell_data_set\\\"))","targetRectangle":{"y":214.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"  assertthat::assert_that(!is.null(reducedDims(cds)[[reduction_method]]),","targetRectangle":{"y":216.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                          msg = paste(\\\"No dimensionality reduction for\\\",","targetRectangle":{"y":218.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                      reduction_method, \\\"calculated.\\\",","targetRectangle":{"y":220.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                                      \\\"Please run reduce_dimensions with\\\",","targetRectangle":{"y":222.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                      \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":224.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"                                      \\\"before attempting to plot.\\\"))","targetRectangle":{"y":226.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"  low_dim_coords <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":228.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  assertthat::assert_that(ncol(low_dim_coords) >=max(x,y),","targetRectangle":{"y":230.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          msg = paste(\\\"x and\/or y is too large. x and y must\\\",","targetRectangle":{"y":232.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be dimensions in reduced dimension\\\",","targetRectangle":{"y":234.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"                                      \\\"space.\\\"))","targetRectangle":{"y":236.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"  if(!is.null(color_cells_by)) {","targetRectangle":{"y":238.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"    assertthat::assert_that(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\",","targetRectangle":{"y":240.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                                                  \\\"pseudotime\\\") |","targetRectangle":{"y":242.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                              color_cells_by %in% names(colData(cds)),","targetRectangle":{"y":244.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            msg = paste(\\\"color_cells_by must one of\\\",","targetRectangle":{"y":246.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                        \\\"'cluster', 'partition', 'pseudotime,\\\",","targetRectangle":{"y":248.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                        \\\"or a column in the colData table.\\\"))","targetRectangle":{"y":250.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    if(color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":254.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      tryCatch({pseudotime(cds, reduction_method = reduction_method)},","targetRectangle":{"y":256.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"               error = function(x) {","targetRectangle":{"y":258.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                 stop(paste(\\\"No pseudotime for\\\", reduction_method,","targetRectangle":{"y":260.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            \\\"calculated. Please run order_cells with\\\",","targetRectangle":{"y":262.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":264.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"                            \\\"before attempting to color by pseudotime.\\\"))})","targetRectangle":{"y":266.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    }","targetRectangle":{"y":270.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":272.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(markers),","targetRectangle":{"y":274.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or markers must\\\",","targetRectangle":{"y":276.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be NULL, cannot color by both!\\\"))","targetRectangle":{"y":278.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"  norm_method = match.arg(norm_method)","targetRectangle":{"y":282.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"  group_cells_by=match.arg(group_cells_by)","targetRectangle":{"y":284.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(genes),","targetRectangle":{"y":286.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or genes must be\\\",","targetRectangle":{"y":288.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                      \\\"NULL, cannot color by both!\\\"))","targetRectangle":{"y":290.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"  if (show_trajectory_graph &&","targetRectangle":{"y":294.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"      is.null(principal_graph(cds)[[reduction_method]])) {","targetRectangle":{"y":296.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    message(\\\"No trajectory to plot. Has learn_graph() been called yet?\\\")","targetRectangle":{"y":298.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    show_trajectory_graph = FALSE","targetRectangle":{"y":300.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  }","targetRectangle":{"y":302.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  gene_short_name <- NA","targetRectangle":{"y":306.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  sample_name <- NA","targetRectangle":{"y":308.00000196695305,"x":362.40000017166153,"width":22.8779296875,"height":2}},{"text":"  #sample_state <- colData(cds)$State","targetRectangle":{"y":310.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  data_dim_1 <- NA","targetRectangle":{"y":312.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  data_dim_2 <- NA","targetRectangle":{"y":314.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  if (rasterize){","targetRectangle":{"y":316.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"    plotting_func <- ggrastr::geom_point_rast","targetRectangle":{"y":318.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"  }else{","targetRectangle":{"y":320.00000196695305,"x":362.40000017166153,"width":9.6328125,"height":2}},{"text":"    plotting_func <- ggplot2::geom_point","targetRectangle":{"y":322.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"  }","targetRectangle":{"y":324.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  S_matrix <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":328.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"  data_df <- data.frame(S_matrix[,c(x,y)])","targetRectangle":{"y":330.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  colnames(data_df) <- c(\\\"data_dim_1\\\", \\\"data_dim_2\\\")","targetRectangle":{"y":334.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"  data_df$sample_name <- row.names(data_df)","targetRectangle":{"y":336.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"  data_df <- as.data.frame(cbind(data_df, colData(cds)))","targetRectangle":{"y":340.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  if (group_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":342.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":344.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":346.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":348.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":350.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":352.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (group_cells_by == \\\"partition\\\") {","targetRectangle":{"y":354.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":356.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":358.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":360.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":362.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":364.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else{","targetRectangle":{"y":366.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    stop(\\\"Error: unrecognized way of grouping cells.\\\")","targetRectangle":{"y":368.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"  }","targetRectangle":{"y":370.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (color_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":374.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":376.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":378.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":380.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":382.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":384.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"partition\\\") {","targetRectangle":{"y":386.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":388.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":390.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":392.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":394.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":396.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":398.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":400.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({pseudotime(cds,","targetRectangle":{"y":402.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":404.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]}, error = function(e) {NULL})","targetRectangle":{"y":406.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"  } else{","targetRectangle":{"y":408.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    data_df$cell_color <- colData(cds)[data_df$sample_name,color_cells_by]","targetRectangle":{"y":410.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"  }","targetRectangle":{"y":412.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Graph info","targetRectangle":{"y":416.00000196695305,"x":362.40000017166153,"width":18.0615234375,"height":2}},{"text":"  if (show_trajectory_graph) {","targetRectangle":{"y":418.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"    ica_space_df <- t(cds@principal_graph_aux[[reduction_method]]$dp_mst) %>%","targetRectangle":{"y":422.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"      as.data.frame() %>%","targetRectangle":{"y":424.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      dplyr::select_(prin_graph_dim_1 = x, prin_graph_dim_2 = y) %>%","targetRectangle":{"y":426.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      dplyr::mutate(sample_name = rownames(.),","targetRectangle":{"y":428.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"                    sample_state = rownames(.))","targetRectangle":{"y":430.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"    dp_mst <- cds@principal_graph[[reduction_method]]","targetRectangle":{"y":434.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"    edge_df <- dp_mst %>%","targetRectangle":{"y":438.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      igraph::as_data_frame() %>%","targetRectangle":{"y":440.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      dplyr::select_(source = \\\"from\\\", target = \\\"to\\\") %>%","targetRectangle":{"y":442.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":444.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":446.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           source=\\\"sample_name\\\",","targetRectangle":{"y":448.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           source_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":450.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           source_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":452.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"source\\\") %>%","targetRectangle":{"y":454.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":456.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":458.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           target=\\\"sample_name\\\",","targetRectangle":{"y":460.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           target_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":462.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           target_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":464.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"target\\\")","targetRectangle":{"y":466.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  }","targetRectangle":{"y":468.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Marker genes","targetRectangle":{"y":472.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"  markers_exprs <- NULL","targetRectangle":{"y":474.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  expression_legend_label <- NULL","targetRectangle":{"y":476.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  if (!is.null(genes)) {","targetRectangle":{"y":478.00000196695305,"x":362.40000017166153,"width":28.8984375,"height":2}},{"text":"    if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":480.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"      markers = unlist(genes[,1], use.names=FALSE)","targetRectangle":{"y":482.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"    } else {","targetRectangle":{"y":484.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      markers = genes","targetRectangle":{"y":486.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"    }","targetRectangle":{"y":488.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    markers_rowData <- as.data.frame(subset(rowData(cds),","targetRectangle":{"y":490.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                                            gene_short_name %in% markers |","targetRectangle":{"y":492.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              row.names(rowData(cds)) %in%","targetRectangle":{"y":494.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              markers))","targetRectangle":{"y":496.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"    if (nrow(markers_rowData) == 0) {","targetRectangle":{"y":498.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      stop(\\\"None of the provided genes were found in the cds\\\")","targetRectangle":{"y":500.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    }","targetRectangle":{"y":502.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (nrow(markers_rowData) >= 1) {","targetRectangle":{"y":504.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      cds_exprs <- SingleCellExperiment::counts(cds)[row.names(markers_rowData), ,drop=FALSE]","targetRectangle":{"y":506.00000196695305,"x":362.40000017166153,"width":111.9814453125,"height":2}},{"text":"      cds_exprs <- Matrix::t(Matrix::t(cds_exprs)\/size_factors(cds))","targetRectangle":{"y":508.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":512.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"        genes = as.data.frame(genes)","targetRectangle":{"y":514.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        row.names(genes) = genes[,1]","targetRectangle":{"y":516.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        genes = genes[row.names(cds_exprs),]","targetRectangle":{"y":518.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"        agg_mat = as.matrix(aggregate_gene_expression(cds, genes, norm_method=norm_method, scale_agg_values=FALSE))","targetRectangle":{"y":522.00000196695305,"x":362.40000017166153,"width":138.4716796875,"height":2}},{"text":"        markers_exprs = agg_mat","targetRectangle":{"y":524.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":526.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":528.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        if (is.factor(genes[,2]))","targetRectangle":{"y":530.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"          markers_exprs$feature_id = factor(markers_exprs$feature_id,","targetRectangle":{"y":532.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                            levels=levels(genes[,2]))","targetRectangle":{"y":534.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        markers_exprs$feature_label <- markers_exprs$feature_id","targetRectangle":{"y":538.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        norm_method = \\\"size_only\\\"","targetRectangle":{"y":540.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        expression_legend_label = \\\"Expression score\\\"","targetRectangle":{"y":542.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"      } else {","targetRectangle":{"y":544.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        cds_exprs@x = round(10000*cds_exprs@x)\/10000","targetRectangle":{"y":546.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        markers_exprs = matrix(cds_exprs, nrow=nrow(markers_rowData))","targetRectangle":{"y":548.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        colnames(markers_exprs) = colnames(SingleCellExperiment::counts(cds))","targetRectangle":{"y":550.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        row.names(markers_exprs) = row.names(markers_rowData)","targetRectangle":{"y":552.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":554.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":556.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        markers_exprs <- merge(markers_exprs, markers_rowData,","targetRectangle":{"y":558.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                               by.x = \\\"feature_id\\\", by.y=\\\"row.names\\\")","targetRectangle":{"y":560.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        if (is.null(markers_exprs$gene_short_name)) {","targetRectangle":{"y":562.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":564.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$feature_id)","targetRectangle":{"y":566.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        } else {","targetRectangle":{"y":568.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":570.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$gene_short_name)","targetRectangle":{"y":572.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"        }","targetRectangle":{"y":574.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        markers_exprs$feature_label <- ifelse(is.na(markers_exprs$feature_label) | !as.character(markers_exprs$feature_label) %in% markers,","targetRectangle":{"y":578.00000196695305,"x":362.40000017166153,"width":167.3701171875,"height":2}},{"text":"                                              as.character(markers_exprs$feature_id),","targetRectangle":{"y":580.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                                              as.character(markers_exprs$feature_label))","targetRectangle":{"y":582.00000196695305,"x":362.40000017166153,"width":105.9609375,"height":2}},{"text":"        markers_exprs$feature_label <- factor(markers_exprs$feature_label,","targetRectangle":{"y":586.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              levels = markers)","targetRectangle":{"y":588.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        if (norm_method == \\\"size_only\\\")","targetRectangle":{"y":590.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"          expression_legend_label = \\\"Expression\\\"","targetRectangle":{"y":592.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        else","targetRectangle":{"y":594.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"          expression_legend_label = \\\"log10(Expression)\\\"","targetRectangle":{"y":596.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      }","targetRectangle":{"y":598.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      if (scale_to_range){","targetRectangle":{"y":602.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        markers_exprs = dplyr::group_by(markers_exprs, feature_label) %>%","targetRectangle":{"y":604.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"          dplyr::mutate(max_val_for_feature = max(value),","targetRectangle":{"y":606.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                        min_val_for_feature = min(value)) %>%","targetRectangle":{"y":608.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"          dplyr::mutate(value = 100 * (value - min_val_for_feature) \/ (max_val_for_feature - min_val_for_feature))","targetRectangle":{"y":610.00000196695305,"x":362.40000017166153,"width":137.267578125,"height":2}},{"text":"        expression_legend_label = \\\"% Max\\\"","targetRectangle":{"y":612.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      }","targetRectangle":{"y":614.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":616.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":618.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (label_cell_groups && is.null(color_cells_by) == FALSE){","targetRectangle":{"y":622.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"    if (is.null(data_df$cell_color)){","targetRectangle":{"y":624.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      if (is.null(genes)){","targetRectangle":{"y":626.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        message(paste(color_cells_by, \\\"not found in colData(cds), cells will\\\",","targetRectangle":{"y":628.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                      \\\"not be colored\\\"))","targetRectangle":{"y":630.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      }","targetRectangle":{"y":632.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      text_df = NULL","targetRectangle":{"y":634.00000196695305,"x":362.40000017166153,"width":24.08203125,"height":2}},{"text":"      label_cell_groups = FALSE","targetRectangle":{"y":636.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"    }else{","targetRectangle":{"y":638.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"      if(is.character(data_df$cell_color) || is.factor(data_df$cell_color)) {","targetRectangle":{"y":640.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        if (label_groups_by_cluster && is.null(data_df$cell_group) == FALSE){","targetRectangle":{"y":644.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"          text_df = data_df %>%","targetRectangle":{"y":646.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"            dplyr::group_by(cell_group) %>%","targetRectangle":{"y":648.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"            dplyr::mutate(cells_in_cluster= dplyr::n()) %>%","targetRectangle":{"y":650.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"            dplyr::group_by(cell_color, add=TRUE) %>%","targetRectangle":{"y":652.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"            dplyr::mutate(per=dplyr::n()\/cells_in_cluster)","targetRectangle":{"y":654.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":656.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":658.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":660.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":662.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":664.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":666.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":668.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":670.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_group) %>%","targetRectangle":{"y":672.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":674.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        } else {","targetRectangle":{"y":676.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          text_df = data_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":678.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::mutate(per=1)","targetRectangle":{"y":680.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":682.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":684.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":686.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":688.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":690.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":692.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":694.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":696.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":698.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":700.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        }","targetRectangle":{"y":702.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        text_df$label = as.character(text_df %>% dplyr::pull(cell_color))","targetRectangle":{"y":706.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"        # I feel like there's probably a good reason for the bit below, but I","targetRectangle":{"y":708.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        # hate it and I'm killing it for now.","targetRectangle":{"y":710.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        # text_df$label <- paste0(1:nrow(text_df))","targetRectangle":{"y":712.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        # text_df$process_label <- paste0(1:nrow(text_df), '_',","targetRectangle":{"y":714.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        # as.character(as.matrix(text_df[, 1])))","targetRectangle":{"y":716.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # process_label <- text_df$process_label","targetRectangle":{"y":718.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # names(process_label) <- as.character(as.matrix(text_df[, 1]))","targetRectangle":{"y":720.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"        # data_df[, group_by] <-","targetRectangle":{"y":722.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"        #  process_label[as.character(data_df[, group_by])]","targetRectangle":{"y":724.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"        # text_df$label = process_label","targetRectangle":{"y":726.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      } else {","targetRectangle":{"y":728.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        message(paste(\\\"Cells aren't colored in a way that allows them to\\\",","targetRectangle":{"y":730.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                      \\\"be grouped.\\\"))","targetRectangle":{"y":732.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"        text_df = NULL","targetRectangle":{"y":734.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"        label_cell_groups = FALSE","targetRectangle":{"y":736.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      }","targetRectangle":{"y":738.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":740.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":742.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (!is.null(markers_exprs) && nrow(markers_exprs) > 0){","targetRectangle":{"y":746.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    data_df <- merge(data_df, markers_exprs, by.x=\\\"sample_name\\\",","targetRectangle":{"y":748.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                     by.y=\\\"cell_id\\\")","targetRectangle":{"y":750.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"    data_df$value <- with(data_df, ifelse(value >= min_expr, value, NA))","targetRectangle":{"y":752.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    na_sub <- data_df[is.na(data_df$value),]","targetRectangle":{"y":754.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"    if(norm_method == \\\"size_only\\\"){","targetRectangle":{"y":756.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":758.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":760.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\", alpha = alpha,","targetRectangle":{"y":762.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                      data = na_sub) +","targetRectangle":{"y":764.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"        plotting_func(aes(color=value), size=I(cell_size),","targetRectangle":{"y":766.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                      stroke = I(cell_stroke), na.rm = TRUE) +","targetRectangle":{"y":768.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":770.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":772.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":774.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":776.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":778.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    } else {","targetRectangle":{"y":780.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":782.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":784.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\",","targetRectangle":{"y":786.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                      data = na_sub, alpha = alpha) +","targetRectangle":{"y":788.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        plotting_func(aes(color=log10(value+min_expr)),","targetRectangle":{"y":790.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                      size=I(cell_size), stroke = I(cell_stroke),","targetRectangle":{"y":792.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                      na.rm = TRUE, alpha = alpha) +","targetRectangle":{"y":794.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":796.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":798.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":800.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":802.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":804.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    }","targetRectangle":{"y":806.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  } else {","targetRectangle":{"y":808.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2))","targetRectangle":{"y":810.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    # We don't want to force users to call order_cells before even being able","targetRectangle":{"y":814.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    # to look at the trajectory, so check whether it's null and if so, just","targetRectangle":{"y":816.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    # don't color the cells","targetRectangle":{"y":818.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"    if(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\")){","targetRectangle":{"y":820.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"      if (is.null(data_df$cell_color)){","targetRectangle":{"y":822.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"        g <- g + geom_point(color=I(\\\"gray\\\"), size=I(cell_size),","targetRectangle":{"y":824.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":826.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = I(alpha))","targetRectangle":{"y":828.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        message(paste(\\\"cluster_cells() has not been called yet, can't\\\",","targetRectangle":{"y":830.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                      \\\"color cells by cluster\\\"))","targetRectangle":{"y":832.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"      } else{","targetRectangle":{"y":834.00000196695305,"x":362.40000017166153,"width":15.6533203125,"height":2}},{"text":"        g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":836.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":838.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = alpha)","targetRectangle":{"y":840.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"      }","targetRectangle":{"y":842.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":844.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":846.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    } else if (class(data_df$cell_color) == \\\"numeric\\\"){","targetRectangle":{"y":848.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":850.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":852.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + viridis::scale_color_viridis(name = color_cells_by, option=\\\"C\\\")","targetRectangle":{"y":854.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"    } else {","targetRectangle":{"y":856.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":858.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":860.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":862.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":864.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    }","targetRectangle":{"y":866.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":870.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (show_trajectory_graph){","targetRectangle":{"y":872.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"    g <- g + geom_segment(aes_string(x=\\\"source_prin_graph_dim_1\\\",","targetRectangle":{"y":874.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     y=\\\"source_prin_graph_dim_2\\\",","targetRectangle":{"y":876.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     xend=\\\"target_prin_graph_dim_1\\\",","targetRectangle":{"y":878.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     yend=\\\"target_prin_graph_dim_2\\\"),","targetRectangle":{"y":880.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          size=trajectory_graph_segment_size,","targetRectangle":{"y":882.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"                          color=I(trajectory_graph_color),","targetRectangle":{"y":884.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          linetype=\\\"solid\\\",","targetRectangle":{"y":886.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"                          na.rm=TRUE,","targetRectangle":{"y":888.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"                          data=edge_df)","targetRectangle":{"y":890.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"    if (label_branch_points){","targetRectangle":{"y":896.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"      mst_branch_nodes <- branch_nodes(cds)","targetRectangle":{"y":898.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"      branch_point_df <- ica_space_df %>%","targetRectangle":{"y":900.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"        dplyr::slice(match(names(mst_branch_nodes), sample_name)) %>%","targetRectangle":{"y":902.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        dplyr::mutate(branch_point_idx = seq_len(dplyr::n()))","targetRectangle":{"y":904.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":908.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":910.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":912.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"white\\\",","targetRectangle":{"y":914.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"black\\\",","targetRectangle":{"y":916.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":918.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE, branch_point_df) +","targetRectangle":{"y":920.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":922.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"branch_point_idx\\\"),","targetRectangle":{"y":924.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"white\\\", na.rm=TRUE,","targetRectangle":{"y":926.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                  branch_point_df)","targetRectangle":{"y":928.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"    }","targetRectangle":{"y":930.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_leaves){","targetRectangle":{"y":934.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"      mst_leaf_nodes <- leaf_nodes(cds)","targetRectangle":{"y":936.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      leaf_df <- ica_space_df %>%","targetRectangle":{"y":938.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_leaf_nodes), sample_name)) %>%","targetRectangle":{"y":940.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(leaf_idx = seq_len(dplyr::n()))","targetRectangle":{"y":942.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":946.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":948.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":950.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":952.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"lightgray\\\",","targetRectangle":{"y":954.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":956.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":958.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   leaf_df) +","targetRectangle":{"y":960.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":962.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"leaf_idx\\\"),","targetRectangle":{"y":964.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, leaf_df)","targetRectangle":{"y":966.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":968.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_roots){","targetRectangle":{"y":972.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"      mst_root_nodes <- root_nodes(cds)","targetRectangle":{"y":974.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      root_df <- ica_space_df %>%","targetRectangle":{"y":976.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_root_nodes), sample_name)) %>%","targetRectangle":{"y":978.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(root_idx = seq_len(dplyr::n()))","targetRectangle":{"y":980.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":984.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":986.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":988.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":990.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"white\\\",","targetRectangle":{"y":992.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":994.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":996.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   root_df) +","targetRectangle":{"y":998.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":1000.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"root_idx\\\"),","targetRectangle":{"y":1002.0000019669531,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, root_df)","targetRectangle":{"y":1004.0000019669531,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":1006.0000019669531,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":1008.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if(label_cell_groups) {","targetRectangle":{"y":1012.0000019669531,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":1014.0000019669531,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":1016.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":1018.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":1020.0000019669531,"x":362.40000017166153,"width":91.51171875,"height":2}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":1022.0000019669531,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":1024.0000019669531,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":1026.0000019669531,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":1028.0000019669531,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"  }","targetRectangle":{"y":1030.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  g <- g +","targetRectangle":{"y":1034.0000019669531,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    #scale_color_brewer(palette=\\\"Set1\\\") +","targetRectangle":{"y":1036.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    monocle_theme_opts() +","targetRectangle":{"y":1038.0000019669531,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"    xlab(paste(reduction_method, x)) +","targetRectangle":{"y":1040.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    ylab(paste(reduction_method, y)) +","targetRectangle":{"y":1042.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    #guides(color = guide_legend(label.position = \\\"top\\\")) +","targetRectangle":{"y":1044.0000019669531,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"    theme(legend.key = element_blank()) +","targetRectangle":{"y":1046.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    theme(panel.background = element_rect(fill='white'))","targetRectangle":{"y":1048.0000019669531,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  g","targetRectangle":{"y":1050.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"}","targetRectangle":{"y":1052.0000019669531,"x":362.40000017166153,"width":1.2041015625,"height":2}},{"text":"plot_cells() from Monocle 3:","targetRectangle":{"y":161.14727131345103,"x":69.851549236991204,"width":235.50550781250001,"height":71.160003662109375}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":1,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"C25C25FF361FB24FC35F6B120D2F252D"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":614,"pointY":59},"width":962,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":62,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.53987096774193555,"textBaseline":0.76631804435483875,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":829,"pointY":98},"width":962,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":62,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"7E09CED92E23CCF90CE5B16A90602C55"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":443.90000017166153,"pointY":606.00000196695305},"width":171,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":896,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.001220703125,"textBaseline":1.0017057168297467,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":88.099999828338468,"pointY":449.99999803304695},"width":171,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":896,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"4296E54C45A6264715204297D66D6DCA"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":811.56660199972066,"pointY":913.86364841461182},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":205,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"3C5A5888-64C5-45F0-A79D-ADC6AC019884","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":324.43339800027934,"pointY":101.13635158538818},"width":652,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":205,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"7C4E1F6010CEF29B83A62B7813154690"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":897.88557350852261,"pointY":501.11730846058242},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":423,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"6DAF87A0-34ED-4E19-8651-E6E8EAC16CF8","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":262.11442649147739,"pointY":209.88269153941758},"width":528,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":423,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BC3F5294029FE4948FE58D45307782EE"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1548.9530545321365,"pointY":488.12738009366115},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":448,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"15A40B61-3DFA-471A-B88B-FB019431093D","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":278.04694546786345,"pointY":222.87261990633885},"width":560,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":448,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BAC3B18083DD6755EA1FCCE1B75491C1"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":153.2666029479287,"pointY":187.14727131345103},"width":222,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":60,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.228271484375,"textBaseline":0.94862253133095464,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0,0,0,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":136.7333970520713,"pointY":41.852728686548971},"width":222,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":60,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"68CD03AE3BD9EE91E8954131BBB0167E"}]}]}]}},{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"13B84F6ECF041FFADE3D17E8724E4B95"},{"animations":[{"timeOffset":0,"from":{"scalar":false},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.01,"to":{"scalar":true}}],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BD50CF5782E79961468EE25A585C263A"}]}]},"effects":[],"duration":0.01,"type":"transition","attributes":{"direction":0},"name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Plots can be built programmatically","targetRectangle":{"y":80,"x":478.11200000000002,"width":963.77599999999984,"height":76.1435546875}},{"text":"pasted-image.tiff","targetRectangle":{"y":264.12738009366115,"x":1268.9530545321365,"width":556.13323974609375,"height":444.90655517578125}},{"text":"if(label_cell_groups) {","targetRectangle":{"y":815.36364841461182,"x":580.76361083984375,"width":166.166015625,"height":18}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":833.36364841461182,"x":580.76361083984375,"width":382.904296875,"height":18}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":851.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":869.36364841461182,"x":580.76361083984375,"width":520.171875,"height":18}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":887.36364841461182,"x":580.76361083984375,"width":549.0703125,"height":18}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":905.36364841461182,"x":580.76361083984375,"width":455.150390625,"height":18}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":923.36364841461182,"x":580.76361083984375,"width":469.599609375,"height":18}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":941.36364841461182,"x":580.76361083984375,"width":223.962890625,"height":18}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":959.36364841461182,"x":580.76361083984375,"width":317.8828125,"height":18}},{"text":"  }","targetRectangle":{"y":977.36364841461182,"x":580.76361083984375,"width":21.673828125,"height":18}},{"text":"pasted-image.tiff","targetRectangle":{"y":289.61730846058242,"x":633.88557350852261,"width":524.76556396484375,"height":419.81240844726574}},{"text":"plot_cells <- function(cds,","targetRectangle":{"y":162.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       x=1,","targetRectangle":{"y":164.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       y=2,","targetRectangle":{"y":166.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"                       reduction_method = c(\\\"UMAP\\\", \\\"tSNE\\\", \\\"PCA\\\", \\\"LSI\\\", \\\"Aligned\\\"),","targetRectangle":{"y":168.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                       color_cells_by=\\\"cluster\\\",","targetRectangle":{"y":170.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       group_cells_by=c(\\\"cluster\\\", \\\"partition\\\"),","targetRectangle":{"y":172.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                       genes=NULL,","targetRectangle":{"y":174.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"                       show_trajectory_graph=TRUE,","targetRectangle":{"y":176.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                       trajectory_graph_color=\\\"grey28\\\",","targetRectangle":{"y":178.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                       trajectory_graph_segment_size=0.75,","targetRectangle":{"y":180.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                       norm_method = c(\\\"log\\\", \\\"size_only\\\"),","targetRectangle":{"y":182.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"                       label_cell_groups = TRUE,","targetRectangle":{"y":184.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_groups_by_cluster=TRUE,","targetRectangle":{"y":186.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"                       group_label_size=2,","targetRectangle":{"y":188.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       labels_per_group=1,","targetRectangle":{"y":190.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       label_branch_points=TRUE,","targetRectangle":{"y":192.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                       label_roots=TRUE,","targetRectangle":{"y":194.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                       label_leaves=TRUE,","targetRectangle":{"y":196.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"                       graph_label_size=2,","targetRectangle":{"y":198.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"                       cell_size=0.35,","targetRectangle":{"y":200.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"                       cell_stroke= I(cell_size \/ 2),","targetRectangle":{"y":202.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                       alpha = 1,","targetRectangle":{"y":204.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                       min_expr=0.1,","targetRectangle":{"y":206.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                       rasterize=FALSE,","targetRectangle":{"y":208.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                       scale_to_range=FALSE) {","targetRectangle":{"y":210.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"  reduction_method <- match.arg(reduction_method)","targetRectangle":{"y":212.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"  assertthat::assert_that(methods::is(cds, \\\"cell_data_set\\\"))","targetRectangle":{"y":214.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"  assertthat::assert_that(!is.null(reducedDims(cds)[[reduction_method]]),","targetRectangle":{"y":216.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                          msg = paste(\\\"No dimensionality reduction for\\\",","targetRectangle":{"y":218.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                      reduction_method, \\\"calculated.\\\",","targetRectangle":{"y":220.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                                      \\\"Please run reduce_dimensions with\\\",","targetRectangle":{"y":222.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                      \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":224.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"                                      \\\"before attempting to plot.\\\"))","targetRectangle":{"y":226.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"  low_dim_coords <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":228.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  assertthat::assert_that(ncol(low_dim_coords) >=max(x,y),","targetRectangle":{"y":230.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          msg = paste(\\\"x and\/or y is too large. x and y must\\\",","targetRectangle":{"y":232.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be dimensions in reduced dimension\\\",","targetRectangle":{"y":234.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"                                      \\\"space.\\\"))","targetRectangle":{"y":236.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"  if(!is.null(color_cells_by)) {","targetRectangle":{"y":238.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"    assertthat::assert_that(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\",","targetRectangle":{"y":240.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"                                                  \\\"pseudotime\\\") |","targetRectangle":{"y":242.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                              color_cells_by %in% names(colData(cds)),","targetRectangle":{"y":244.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            msg = paste(\\\"color_cells_by must one of\\\",","targetRectangle":{"y":246.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                        \\\"'cluster', 'partition', 'pseudotime,\\\",","targetRectangle":{"y":248.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                        \\\"or a column in the colData table.\\\"))","targetRectangle":{"y":250.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    if(color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":254.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      tryCatch({pseudotime(cds, reduction_method = reduction_method)},","targetRectangle":{"y":256.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"               error = function(x) {","targetRectangle":{"y":258.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                 stop(paste(\\\"No pseudotime for\\\", reduction_method,","targetRectangle":{"y":260.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            \\\"calculated. Please run order_cells with\\\",","targetRectangle":{"y":262.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                            \\\"reduction_method =\\\", reduction_method,","targetRectangle":{"y":264.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"                            \\\"before attempting to color by pseudotime.\\\"))})","targetRectangle":{"y":266.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    }","targetRectangle":{"y":270.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":272.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(markers),","targetRectangle":{"y":274.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or markers must\\\",","targetRectangle":{"y":276.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                                      \\\"be NULL, cannot color by both!\\\"))","targetRectangle":{"y":278.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"  norm_method = match.arg(norm_method)","targetRectangle":{"y":282.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"  group_cells_by=match.arg(group_cells_by)","targetRectangle":{"y":284.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  assertthat::assert_that(!is.null(color_cells_by) || !is.null(genes),","targetRectangle":{"y":286.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                          msg = paste(\\\"Either color_cells_by or genes must be\\\",","targetRectangle":{"y":288.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                                      \\\"NULL, cannot color by both!\\\"))","targetRectangle":{"y":290.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"  if (show_trajectory_graph &&","targetRectangle":{"y":294.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"      is.null(principal_graph(cds)[[reduction_method]])) {","targetRectangle":{"y":296.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    message(\\\"No trajectory to plot. Has learn_graph() been called yet?\\\")","targetRectangle":{"y":298.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    show_trajectory_graph = FALSE","targetRectangle":{"y":300.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  }","targetRectangle":{"y":302.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  gene_short_name <- NA","targetRectangle":{"y":306.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  sample_name <- NA","targetRectangle":{"y":308.00000196695305,"x":362.40000017166153,"width":22.8779296875,"height":2}},{"text":"  #sample_state <- colData(cds)$State","targetRectangle":{"y":310.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  data_dim_1 <- NA","targetRectangle":{"y":312.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  data_dim_2 <- NA","targetRectangle":{"y":314.00000196695305,"x":362.40000017166153,"width":21.673828125,"height":2}},{"text":"  if (rasterize){","targetRectangle":{"y":316.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"    plotting_func <- ggrastr::geom_point_rast","targetRectangle":{"y":318.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"  }else{","targetRectangle":{"y":320.00000196695305,"x":362.40000017166153,"width":9.6328125,"height":2}},{"text":"    plotting_func <- ggplot2::geom_point","targetRectangle":{"y":322.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"  }","targetRectangle":{"y":324.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  S_matrix <- reducedDims(cds)[[reduction_method]]","targetRectangle":{"y":328.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"  data_df <- data.frame(S_matrix[,c(x,y)])","targetRectangle":{"y":330.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  colnames(data_df) <- c(\\\"data_dim_1\\\", \\\"data_dim_2\\\")","targetRectangle":{"y":334.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"  data_df$sample_name <- row.names(data_df)","targetRectangle":{"y":336.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"  data_df <- as.data.frame(cbind(data_df, colData(cds)))","targetRectangle":{"y":340.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  if (group_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":342.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":344.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":346.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":348.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":350.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":352.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (group_cells_by == \\\"partition\\\") {","targetRectangle":{"y":354.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_group <-","targetRectangle":{"y":356.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":358.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":360.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":362.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":364.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else{","targetRectangle":{"y":366.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    stop(\\\"Error: unrecognized way of grouping cells.\\\")","targetRectangle":{"y":368.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"  }","targetRectangle":{"y":370.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (color_cells_by == \\\"cluster\\\"){","targetRectangle":{"y":374.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":376.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({clusters(cds,","targetRectangle":{"y":378.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"                         reduction_method = reduction_method)[","targetRectangle":{"y":380.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                           data_df$sample_name]},","targetRectangle":{"y":382.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":384.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"partition\\\") {","targetRectangle":{"y":386.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":388.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({partitions(cds,","targetRectangle":{"y":390.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":392.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]},","targetRectangle":{"y":394.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"               error = function(e) {NULL})","targetRectangle":{"y":396.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"  } else if (color_cells_by == \\\"pseudotime\\\") {","targetRectangle":{"y":398.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"    data_df$cell_color <-","targetRectangle":{"y":400.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      tryCatch({pseudotime(cds,","targetRectangle":{"y":402.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"                           reduction_method = reduction_method)[","targetRectangle":{"y":404.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                             data_df$sample_name]}, error = function(e) {NULL})","targetRectangle":{"y":406.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"  } else{","targetRectangle":{"y":408.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"    data_df$cell_color <- colData(cds)[data_df$sample_name,color_cells_by]","targetRectangle":{"y":410.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"  }","targetRectangle":{"y":412.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Graph info","targetRectangle":{"y":416.00000196695305,"x":362.40000017166153,"width":18.0615234375,"height":2}},{"text":"  if (show_trajectory_graph) {","targetRectangle":{"y":418.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"    ica_space_df <- t(cds@principal_graph_aux[[reduction_method]]$dp_mst) %>%","targetRectangle":{"y":422.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"      as.data.frame() %>%","targetRectangle":{"y":424.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      dplyr::select_(prin_graph_dim_1 = x, prin_graph_dim_2 = y) %>%","targetRectangle":{"y":426.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      dplyr::mutate(sample_name = rownames(.),","targetRectangle":{"y":428.00000196695305,"x":362.40000017166153,"width":55.388671875,"height":2}},{"text":"                    sample_state = rownames(.))","targetRectangle":{"y":430.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"    dp_mst <- cds@principal_graph[[reduction_method]]","targetRectangle":{"y":434.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"    edge_df <- dp_mst %>%","targetRectangle":{"y":438.00000196695305,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"      igraph::as_data_frame() %>%","targetRectangle":{"y":440.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      dplyr::select_(source = \\\"from\\\", target = \\\"to\\\") %>%","targetRectangle":{"y":442.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":444.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":446.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           source=\\\"sample_name\\\",","targetRectangle":{"y":448.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           source_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":450.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           source_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":452.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"source\\\") %>%","targetRectangle":{"y":454.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      dplyr::left_join(ica_space_df %>%","targetRectangle":{"y":456.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"                         dplyr::select_(","targetRectangle":{"y":458.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"                           target=\\\"sample_name\\\",","targetRectangle":{"y":460.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"                           target_prin_graph_dim_1=\\\"prin_graph_dim_1\\\",","targetRectangle":{"y":462.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                           target_prin_graph_dim_2=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":464.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                       by = \\\"target\\\")","targetRectangle":{"y":466.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"  }","targetRectangle":{"y":468.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  ## Marker genes","targetRectangle":{"y":472.00000196695305,"x":362.40000017166153,"width":20.4697265625,"height":2}},{"text":"  markers_exprs <- NULL","targetRectangle":{"y":474.00000196695305,"x":362.40000017166153,"width":27.6943359375,"height":2}},{"text":"  expression_legend_label <- NULL","targetRectangle":{"y":476.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"  if (!is.null(genes)) {","targetRectangle":{"y":478.00000196695305,"x":362.40000017166153,"width":28.8984375,"height":2}},{"text":"    if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":480.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"      markers = unlist(genes[,1], use.names=FALSE)","targetRectangle":{"y":482.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"    } else {","targetRectangle":{"y":484.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      markers = genes","targetRectangle":{"y":486.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"    }","targetRectangle":{"y":488.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    markers_rowData <- as.data.frame(subset(rowData(cds),","targetRectangle":{"y":490.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                                            gene_short_name %in% markers |","targetRectangle":{"y":492.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              row.names(rowData(cds)) %in%","targetRectangle":{"y":494.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              markers))","targetRectangle":{"y":496.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"    if (nrow(markers_rowData) == 0) {","targetRectangle":{"y":498.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      stop(\\\"None of the provided genes were found in the cds\\\")","targetRectangle":{"y":500.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    }","targetRectangle":{"y":502.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (nrow(markers_rowData) >= 1) {","targetRectangle":{"y":504.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      cds_exprs <- SingleCellExperiment::counts(cds)[row.names(markers_rowData), ,drop=FALSE]","targetRectangle":{"y":506.00000196695305,"x":362.40000017166153,"width":111.9814453125,"height":2}},{"text":"      cds_exprs <- Matrix::t(Matrix::t(cds_exprs)\/size_factors(cds))","targetRectangle":{"y":508.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"      if (!is.null(dim(genes)) && dim(genes) >= 2){","targetRectangle":{"y":512.00000196695305,"x":362.40000017166153,"width":61.4091796875,"height":2}},{"text":"        genes = as.data.frame(genes)","targetRectangle":{"y":514.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        row.names(genes) = genes[,1]","targetRectangle":{"y":516.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"        genes = genes[row.names(cds_exprs),]","targetRectangle":{"y":518.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"        agg_mat = as.matrix(aggregate_gene_expression(cds, genes, norm_method=norm_method, scale_agg_values=FALSE))","targetRectangle":{"y":522.00000196695305,"x":362.40000017166153,"width":138.4716796875,"height":2}},{"text":"        markers_exprs = agg_mat","targetRectangle":{"y":524.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":526.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":528.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        if (is.factor(genes[,2]))","targetRectangle":{"y":530.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"          markers_exprs$feature_id = factor(markers_exprs$feature_id,","targetRectangle":{"y":532.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                                            levels=levels(genes[,2]))","targetRectangle":{"y":534.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        markers_exprs$feature_label <- markers_exprs$feature_id","targetRectangle":{"y":538.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        norm_method = \\\"size_only\\\"","targetRectangle":{"y":540.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        expression_legend_label = \\\"Expression score\\\"","targetRectangle":{"y":542.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"      } else {","targetRectangle":{"y":544.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        cds_exprs@x = round(10000*cds_exprs@x)\/10000","targetRectangle":{"y":546.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        markers_exprs = matrix(cds_exprs, nrow=nrow(markers_rowData))","targetRectangle":{"y":548.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        colnames(markers_exprs) = colnames(SingleCellExperiment::counts(cds))","targetRectangle":{"y":550.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        row.names(markers_exprs) = row.names(markers_rowData)","targetRectangle":{"y":552.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"        markers_exprs <- reshape2::melt(markers_exprs)","targetRectangle":{"y":554.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"        colnames(markers_exprs)[1:2] <- c('feature_id','cell_id')","targetRectangle":{"y":556.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"        markers_exprs <- merge(markers_exprs, markers_rowData,","targetRectangle":{"y":558.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"                               by.x = \\\"feature_id\\\", by.y=\\\"row.names\\\")","targetRectangle":{"y":560.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        if (is.null(markers_exprs$gene_short_name)) {","targetRectangle":{"y":562.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":564.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$feature_id)","targetRectangle":{"y":566.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        } else {","targetRectangle":{"y":568.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          markers_exprs$feature_label <-","targetRectangle":{"y":570.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"            as.character(markers_exprs$gene_short_name)","targetRectangle":{"y":572.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"        }","targetRectangle":{"y":574.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        markers_exprs$feature_label <- ifelse(is.na(markers_exprs$feature_label) | !as.character(markers_exprs$feature_label) %in% markers,","targetRectangle":{"y":578.00000196695305,"x":362.40000017166153,"width":167.3701171875,"height":2}},{"text":"                                              as.character(markers_exprs$feature_id),","targetRectangle":{"y":580.00000196695305,"x":362.40000017166153,"width":102.3486328125,"height":2}},{"text":"                                              as.character(markers_exprs$feature_label))","targetRectangle":{"y":582.00000196695305,"x":362.40000017166153,"width":105.9609375,"height":2}},{"text":"        markers_exprs$feature_label <- factor(markers_exprs$feature_label,","targetRectangle":{"y":586.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                                              levels = markers)","targetRectangle":{"y":588.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        if (norm_method == \\\"size_only\\\")","targetRectangle":{"y":590.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"          expression_legend_label = \\\"Expression\\\"","targetRectangle":{"y":592.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        else","targetRectangle":{"y":594.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"          expression_legend_label = \\\"log10(Expression)\\\"","targetRectangle":{"y":596.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      }","targetRectangle":{"y":598.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      if (scale_to_range){","targetRectangle":{"y":602.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        markers_exprs = dplyr::group_by(markers_exprs, feature_label) %>%","targetRectangle":{"y":604.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"          dplyr::mutate(max_val_for_feature = max(value),","targetRectangle":{"y":606.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"                        min_val_for_feature = min(value)) %>%","targetRectangle":{"y":608.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"          dplyr::mutate(value = 100 * (value - min_val_for_feature) \/ (max_val_for_feature - min_val_for_feature))","targetRectangle":{"y":610.00000196695305,"x":362.40000017166153,"width":137.267578125,"height":2}},{"text":"        expression_legend_label = \\\"% Max\\\"","targetRectangle":{"y":612.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"      }","targetRectangle":{"y":614.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":616.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":618.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (label_cell_groups && is.null(color_cells_by) == FALSE){","targetRectangle":{"y":622.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"    if (is.null(data_df$cell_color)){","targetRectangle":{"y":624.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"      if (is.null(genes)){","targetRectangle":{"y":626.00000196695305,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"        message(paste(color_cells_by, \\\"not found in colData(cds), cells will\\\",","targetRectangle":{"y":628.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"                      \\\"not be colored\\\"))","targetRectangle":{"y":630.00000196695305,"x":362.40000017166153,"width":48.1640625,"height":2}},{"text":"      }","targetRectangle":{"y":632.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      text_df = NULL","targetRectangle":{"y":634.00000196695305,"x":362.40000017166153,"width":24.08203125,"height":2}},{"text":"      label_cell_groups = FALSE","targetRectangle":{"y":636.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"    }else{","targetRectangle":{"y":638.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"      if(is.character(data_df$cell_color) || is.factor(data_df$cell_color)) {","targetRectangle":{"y":640.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        if (label_groups_by_cluster && is.null(data_df$cell_group) == FALSE){","targetRectangle":{"y":644.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"          text_df = data_df %>%","targetRectangle":{"y":646.00000196695305,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"            dplyr::group_by(cell_group) %>%","targetRectangle":{"y":648.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"            dplyr::mutate(cells_in_cluster= dplyr::n()) %>%","targetRectangle":{"y":650.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"            dplyr::group_by(cell_color, add=TRUE) %>%","targetRectangle":{"y":652.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"            dplyr::mutate(per=dplyr::n()\/cells_in_cluster)","targetRectangle":{"y":654.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":656.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":658.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":660.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":662.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":664.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":666.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":668.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":670.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_group) %>%","targetRectangle":{"y":672.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":674.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        } else {","targetRectangle":{"y":676.00000196695305,"x":362.40000017166153,"width":19.265625,"height":2}},{"text":"          text_df = data_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":678.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::mutate(per=1)","targetRectangle":{"y":680.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"          median_coord_df = text_df %>%","targetRectangle":{"y":682.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"            dplyr::summarize(fraction_of_group = dplyr::n(),","targetRectangle":{"y":684.00000196695305,"x":362.40000017166153,"width":72.24609375,"height":2}},{"text":"                             text_x = stats::median(x = data_dim_1),","targetRectangle":{"y":686.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                             text_y = stats::median(x = data_dim_2))","targetRectangle":{"y":688.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"          text_df = suppressMessages(text_df %>% dplyr::select(per) %>%","targetRectangle":{"y":690.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                                       dplyr::distinct())","targetRectangle":{"y":692.00000196695305,"x":362.40000017166153,"width":68.6337890625,"height":2}},{"text":"          text_df = suppressMessages(dplyr::inner_join(text_df,","targetRectangle":{"y":694.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                                                       median_coord_df))","targetRectangle":{"y":696.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"          text_df = text_df %>% dplyr::group_by(cell_color) %>%","targetRectangle":{"y":698.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"            dplyr::top_n(labels_per_group, per)","targetRectangle":{"y":700.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"        }","targetRectangle":{"y":702.00000196695305,"x":362.40000017166153,"width":10.8369140625,"height":2}},{"text":"        text_df$label = as.character(text_df %>% dplyr::pull(cell_color))","targetRectangle":{"y":706.00000196695305,"x":362.40000017166153,"width":87.8994140625,"height":2}},{"text":"        # I feel like there's probably a good reason for the bit below, but I","targetRectangle":{"y":708.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"        # hate it and I'm killing it for now.","targetRectangle":{"y":710.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        # text_df$label <- paste0(1:nrow(text_df))","targetRectangle":{"y":712.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"        # text_df$process_label <- paste0(1:nrow(text_df), '_',","targetRectangle":{"y":714.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"        # as.character(as.matrix(text_df[, 1])))","targetRectangle":{"y":716.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # process_label <- text_df$process_label","targetRectangle":{"y":718.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"        # names(process_label) <- as.character(as.matrix(text_df[, 1]))","targetRectangle":{"y":720.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"        # data_df[, group_by] <-","targetRectangle":{"y":722.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"        #  process_label[as.character(data_df[, group_by])]","targetRectangle":{"y":724.00000196695305,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"        # text_df$label = process_label","targetRectangle":{"y":726.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      } else {","targetRectangle":{"y":728.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        message(paste(\\\"Cells aren't colored in a way that allows them to\\\",","targetRectangle":{"y":730.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                      \\\"be grouped.\\\"))","targetRectangle":{"y":732.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"        text_df = NULL","targetRectangle":{"y":734.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"        label_cell_groups = FALSE","targetRectangle":{"y":736.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"      }","targetRectangle":{"y":738.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"    }","targetRectangle":{"y":740.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":742.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (!is.null(markers_exprs) && nrow(markers_exprs) > 0){","targetRectangle":{"y":746.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    data_df <- merge(data_df, markers_exprs, by.x=\\\"sample_name\\\",","targetRectangle":{"y":748.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                     by.y=\\\"cell_id\\\")","targetRectangle":{"y":750.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"    data_df$value <- with(data_df, ifelse(value >= min_expr, value, NA))","targetRectangle":{"y":752.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"    na_sub <- data_df[is.na(data_df$value),]","targetRectangle":{"y":754.00000196695305,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"    if(norm_method == \\\"size_only\\\"){","targetRectangle":{"y":756.00000196695305,"x":362.40000017166153,"width":42.1435546875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":758.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":760.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\", alpha = alpha,","targetRectangle":{"y":762.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"                      data = na_sub) +","targetRectangle":{"y":764.00000196695305,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"        plotting_func(aes(color=value), size=I(cell_size),","targetRectangle":{"y":766.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                      stroke = I(cell_stroke), na.rm = TRUE) +","targetRectangle":{"y":768.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":770.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":772.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":774.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":776.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":778.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    } else {","targetRectangle":{"y":780.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2)) +","targetRectangle":{"y":782.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"        plotting_func(aes(data_dim_1, data_dim_2), size=I(cell_size),","targetRectangle":{"y":784.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                      stroke = I(cell_stroke), color = \\\"grey80\\\",","targetRectangle":{"y":786.00000196695305,"x":362.40000017166153,"width":77.0625,"height":2}},{"text":"                      data = na_sub, alpha = alpha) +","targetRectangle":{"y":788.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        plotting_func(aes(color=log10(value+min_expr)),","targetRectangle":{"y":790.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                      size=I(cell_size), stroke = I(cell_stroke),","targetRectangle":{"y":792.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                      na.rm = TRUE, alpha = alpha) +","targetRectangle":{"y":794.00000196695305,"x":362.40000017166153,"width":62.61328125,"height":2}},{"text":"        viridis::scale_color_viridis(option = \\\"viridis\\\",","targetRectangle":{"y":796.00000196695305,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"                                     name = expression_legend_label,","targetRectangle":{"y":798.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     na.value = \\\"grey80\\\", end = 0.8,","targetRectangle":{"y":800.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     alpha = alpha) +","targetRectangle":{"y":802.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"        guides(alpha = FALSE) + facet_wrap(~feature_label)","targetRectangle":{"y":804.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"    }","targetRectangle":{"y":806.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  } else {","targetRectangle":{"y":808.00000196695305,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    g <- ggplot(data=data_df, aes(x=data_dim_1, y=data_dim_2))","targetRectangle":{"y":810.00000196695305,"x":362.40000017166153,"width":74.654296875,"height":2}},{"text":"    # We don't want to force users to call order_cells before even being able","targetRectangle":{"y":814.00000196695305,"x":362.40000017166153,"width":92.7158203125,"height":2}},{"text":"    # to look at the trajectory, so check whether it's null and if so, just","targetRectangle":{"y":816.00000196695305,"x":362.40000017166153,"width":90.3076171875,"height":2}},{"text":"    # don't color the cells","targetRectangle":{"y":818.00000196695305,"x":362.40000017166153,"width":32.5107421875,"height":2}},{"text":"    if(color_cells_by %in% c(\\\"cluster\\\", \\\"partition\\\")){","targetRectangle":{"y":820.00000196695305,"x":362.40000017166153,"width":65.021484375,"height":2}},{"text":"      if (is.null(data_df$cell_color)){","targetRectangle":{"y":822.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"        g <- g + geom_point(color=I(\\\"gray\\\"), size=I(cell_size),","targetRectangle":{"y":824.00000196695305,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":826.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = I(alpha))","targetRectangle":{"y":828.00000196695305,"x":362.40000017166153,"width":54.1845703125,"height":2}},{"text":"        message(paste(\\\"cluster_cells() has not been called yet, can't\\\",","targetRectangle":{"y":830.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                      \\\"color cells by cluster\\\"))","targetRectangle":{"y":832.00000196695305,"x":362.40000017166153,"width":57.796875,"height":2}},{"text":"      } else{","targetRectangle":{"y":834.00000196695305,"x":362.40000017166153,"width":15.6533203125,"height":2}},{"text":"        g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":836.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                            stroke = I(cell_stroke), na.rm = TRUE,","targetRectangle":{"y":838.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                            alpha = alpha)","targetRectangle":{"y":840.00000196695305,"x":362.40000017166153,"width":50.572265625,"height":2}},{"text":"      }","targetRectangle":{"y":842.00000196695305,"x":362.40000017166153,"width":8.4287109375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":844.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":846.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    } else if (class(data_df$cell_color) == \\\"numeric\\\"){","targetRectangle":{"y":848.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":850.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":852.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + viridis::scale_color_viridis(name = color_cells_by, option=\\\"C\\\")","targetRectangle":{"y":854.00000196695305,"x":362.40000017166153,"width":93.919921875,"height":2}},{"text":"    } else {","targetRectangle":{"y":856.00000196695305,"x":362.40000017166153,"width":14.44921875,"height":2}},{"text":"      g <- g + geom_point(aes(color = cell_color), size=I(cell_size),","targetRectangle":{"y":858.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          stroke = I(cell_stroke), na.rm = TRUE, alpha = alpha)","targetRectangle":{"y":860.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"      g <- g + guides(color = guide_legend(title = color_cells_by,","targetRectangle":{"y":862.00000196695305,"x":362.40000017166153,"width":79.470703125,"height":2}},{"text":"                                           override.aes = list(size = 4)))","targetRectangle":{"y":864.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"    }","targetRectangle":{"y":866.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":870.00000196695305,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if (show_trajectory_graph){","targetRectangle":{"y":872.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"    g <- g + geom_segment(aes_string(x=\\\"source_prin_graph_dim_1\\\",","targetRectangle":{"y":874.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     y=\\\"source_prin_graph_dim_2\\\",","targetRectangle":{"y":876.00000196695305,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"                                     xend=\\\"target_prin_graph_dim_1\\\",","targetRectangle":{"y":878.00000196695305,"x":362.40000017166153,"width":81.87890625,"height":2}},{"text":"                                     yend=\\\"target_prin_graph_dim_2\\\"),","targetRectangle":{"y":880.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"                          size=trajectory_graph_segment_size,","targetRectangle":{"y":882.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"                          color=I(trajectory_graph_color),","targetRectangle":{"y":884.00000196695305,"x":362.40000017166153,"width":69.837890625,"height":2}},{"text":"                          linetype=\\\"solid\\\",","targetRectangle":{"y":886.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"                          na.rm=TRUE,","targetRectangle":{"y":888.00000196695305,"x":362.40000017166153,"width":44.5517578125,"height":2}},{"text":"                          data=edge_df)","targetRectangle":{"y":890.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"    if (label_branch_points){","targetRectangle":{"y":896.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"      mst_branch_nodes <- branch_nodes(cds)","targetRectangle":{"y":898.00000196695305,"x":362.40000017166153,"width":51.7763671875,"height":2}},{"text":"      branch_point_df <- ica_space_df %>%","targetRectangle":{"y":900.00000196695305,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"        dplyr::slice(match(names(mst_branch_nodes), sample_name)) %>%","targetRectangle":{"y":902.00000196695305,"x":362.40000017166153,"width":83.0830078125,"height":2}},{"text":"        dplyr::mutate(branch_point_idx = seq_len(dplyr::n()))","targetRectangle":{"y":904.00000196695305,"x":362.40000017166153,"width":73.4501953125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":908.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":910.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":912.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"white\\\",","targetRectangle":{"y":914.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"black\\\",","targetRectangle":{"y":916.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":918.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE, branch_point_df) +","targetRectangle":{"y":920.00000196695305,"x":362.40000017166153,"width":59.0009765625,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":922.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"branch_point_idx\\\"),","targetRectangle":{"y":924.00000196695305,"x":362.40000017166153,"width":66.2255859375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"white\\\", na.rm=TRUE,","targetRectangle":{"y":926.00000196695305,"x":362.40000017166153,"width":84.287109375,"height":2}},{"text":"                  branch_point_df)","targetRectangle":{"y":928.00000196695305,"x":362.40000017166153,"width":40.939453125,"height":2}},{"text":"    }","targetRectangle":{"y":930.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_leaves){","targetRectangle":{"y":934.00000196695305,"x":362.40000017166153,"width":26.490234375,"height":2}},{"text":"      mst_leaf_nodes <- leaf_nodes(cds)","targetRectangle":{"y":936.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      leaf_df <- ica_space_df %>%","targetRectangle":{"y":938.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_leaf_nodes), sample_name)) %>%","targetRectangle":{"y":940.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(leaf_idx = seq_len(dplyr::n()))","targetRectangle":{"y":942.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":946.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":948.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":950.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":952.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"lightgray\\\",","targetRectangle":{"y":954.00000196695305,"x":362.40000017166153,"width":43.34765625,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":956.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":958.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   leaf_df) +","targetRectangle":{"y":960.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":962.00000196695305,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"leaf_idx\\\"),","targetRectangle":{"y":964.00000196695305,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, leaf_df)","targetRectangle":{"y":966.00000196695305,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":968.00000196695305,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"    if (label_roots){","targetRectangle":{"y":972.00000196695305,"x":362.40000017166153,"width":25.2861328125,"height":2}},{"text":"      mst_root_nodes <- root_nodes(cds)","targetRectangle":{"y":974.00000196695305,"x":362.40000017166153,"width":46.9599609375,"height":2}},{"text":"      root_df <- ica_space_df %>%","targetRectangle":{"y":976.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"        dplyr::slice(match(names(mst_root_nodes), sample_name)) %>%","targetRectangle":{"y":978.00000196695305,"x":362.40000017166153,"width":80.6748046875,"height":2}},{"text":"        dplyr::mutate(root_idx = seq_len(dplyr::n()))","targetRectangle":{"y":980.00000196695305,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"      g <- g +","targetRectangle":{"y":984.00000196695305,"x":362.40000017166153,"width":16.857421875,"height":2}},{"text":"        geom_point(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\"),","targetRectangle":{"y":986.00000196695305,"x":362.40000017166153,"width":89.103515625,"height":2}},{"text":"                   shape = 21, stroke=I(trajectory_graph_segment_size),","targetRectangle":{"y":988.00000196695305,"x":362.40000017166153,"width":85.4912109375,"height":2}},{"text":"                   color=\\\"black\\\",","targetRectangle":{"y":990.00000196695305,"x":362.40000017166153,"width":39.7353515625,"height":2}},{"text":"                   fill=\\\"white\\\",","targetRectangle":{"y":992.00000196695305,"x":362.40000017166153,"width":38.53125,"height":2}},{"text":"                   size=I(graph_label_size * 1.5),","targetRectangle":{"y":994.00000196695305,"x":362.40000017166153,"width":60.205078125,"height":2}},{"text":"                   na.rm=TRUE,","targetRectangle":{"y":996.00000196695305,"x":362.40000017166153,"width":36.123046875,"height":2}},{"text":"                   root_df) +","targetRectangle":{"y":998.00000196695305,"x":362.40000017166153,"width":34.9189453125,"height":2}},{"text":"        geom_text(aes_string(x=\\\"prin_graph_dim_1\\\", y=\\\"prin_graph_dim_2\\\",","targetRectangle":{"y":1000.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                             label=\\\"root_idx\\\"),","targetRectangle":{"y":1002.0000019669531,"x":362.40000017166153,"width":56.5927734375,"height":2}},{"text":"                  size=I(graph_label_size), color=\\\"black\\\", na.rm=TRUE, root_df)","targetRectangle":{"y":1004.0000019669531,"x":362.40000017166153,"width":95.1240234375,"height":2}},{"text":"    }","targetRectangle":{"y":1006.0000019669531,"x":362.40000017166153,"width":6.0205078125,"height":2}},{"text":"  }","targetRectangle":{"y":1008.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  if(label_cell_groups) {","targetRectangle":{"y":1012.0000019669531,"x":362.40000017166153,"width":30.1025390625,"height":2}},{"text":"    g <- g + ggrepel::geom_text_repel(data = text_df,","targetRectangle":{"y":1014.0000019669531,"x":362.40000017166153,"width":63.8173828125,"height":2}},{"text":"                                      mapping = aes_string(x = \\\"text_x\\\",","targetRectangle":{"y":1016.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           y = \\\"text_y\\\",","targetRectangle":{"y":1018.0000019669531,"x":362.40000017166153,"width":86.6953125,"height":2}},{"text":"                                                           label = \\\"label\\\"),","targetRectangle":{"y":1020.0000019669531,"x":362.40000017166153,"width":91.51171875,"height":2}},{"text":"                                      size=I(group_label_size))","targetRectangle":{"y":1022.0000019669531,"x":362.40000017166153,"width":75.8583984375,"height":2}},{"text":"    # If we're coloring by gene expression, don't hide the legend","targetRectangle":{"y":1024.0000019669531,"x":362.40000017166153,"width":78.2666015625,"height":2}},{"text":"    if (is.null(markers_exprs))","targetRectangle":{"y":1026.0000019669531,"x":362.40000017166153,"width":37.3271484375,"height":2}},{"text":"      g <- g + theme(legend.position=\\\"none\\\")","targetRectangle":{"y":1028.0000019669531,"x":362.40000017166153,"width":52.98046875,"height":2}},{"text":"  }","targetRectangle":{"y":1030.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"  g <- g +","targetRectangle":{"y":1034.0000019669531,"x":362.40000017166153,"width":12.041015625,"height":2}},{"text":"    #scale_color_brewer(palette=\\\"Set1\\\") +","targetRectangle":{"y":1036.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    monocle_theme_opts() +","targetRectangle":{"y":1038.0000019669531,"x":362.40000017166153,"width":31.306640625,"height":2}},{"text":"    xlab(paste(reduction_method, x)) +","targetRectangle":{"y":1040.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    ylab(paste(reduction_method, y)) +","targetRectangle":{"y":1042.0000019669531,"x":362.40000017166153,"width":45.755859375,"height":2}},{"text":"    #guides(color = guide_legend(label.position = \\\"top\\\")) +","targetRectangle":{"y":1044.0000019669531,"x":362.40000017166153,"width":71.0419921875,"height":2}},{"text":"    theme(legend.key = element_blank()) +","targetRectangle":{"y":1046.0000019669531,"x":362.40000017166153,"width":49.3681640625,"height":2}},{"text":"    theme(panel.background = element_rect(fill='white'))","targetRectangle":{"y":1048.0000019669531,"x":362.40000017166153,"width":67.4296875,"height":2}},{"text":"  g","targetRectangle":{"y":1050.0000019669531,"x":362.40000017166153,"width":3.6123046875,"height":2}},{"text":"}","targetRectangle":{"y":1052.0000019669531,"x":362.40000017166153,"width":1.2041015625,"height":2}},{"text":"plot_cells() from Monocle 3:","targetRectangle":{"y":161.14727131345103,"x":69.851549236991204,"width":235.50550781250001,"height":71.160003662109375}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"BD50CF5782E79961468EE25A585C263A"}]}]}}]}